<!DOCTYPE html>
<!-- saved from url=(0031)https://dlunizg.github.io/lab3/ -->
<html><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
    
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <title>vježba: modeliranje nizova povratnim neuronskim mrežama</title>
    <meta name="viewport" content="width=device-width">
    <meta name="description" content="Materijali i laboratorijske vježbe iz predmeta Duboko Učenje">
    <link rel="canonical" href="http://dlunizg.github.io/lab3/">

    <!-- Custom CSS -->
    <link rel="stylesheet" href="./vježba_ modeliranje nizova povratnim neuronskim mrežama_files/main.css">

    <!-- Google fonts -->
    <link href="./vježba_ modeliranje nizova povratnim neuronskim mrežama_files/css" rel="stylesheet" type="text/css">

    <!-- Google tracking -->
    <script async="" src="./vježba_ modeliranje nizova povratnim neuronskim mrežama_files/analytics.js.download"></script><script>
      (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
      })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

      ga('create', 'UA-46895817-2', 'auto');
      ga('send', 'pageview');

    </script>
    
<style type="text/css">.MathJax_Hover_Frame {border-radius: .25em; -webkit-border-radius: .25em; -moz-border-radius: .25em; -khtml-border-radius: .25em; box-shadow: 0px 0px 15px #83A; -webkit-box-shadow: 0px 0px 15px #83A; -moz-box-shadow: 0px 0px 15px #83A; -khtml-box-shadow: 0px 0px 15px #83A; border: 1px solid #A6D ! important; display: inline-block; position: absolute}
.MathJax_Menu_Button .MathJax_Hover_Arrow {position: absolute; cursor: pointer; display: inline-block; border: 2px solid #AAA; border-radius: 4px; -webkit-border-radius: 4px; -moz-border-radius: 4px; -khtml-border-radius: 4px; font-family: 'Courier New',Courier; font-size: 9px; color: #F0F0F0}
.MathJax_Menu_Button .MathJax_Hover_Arrow span {display: block; background-color: #AAA; border: 1px solid; border-radius: 3px; line-height: 0; padding: 4px}
.MathJax_Hover_Arrow:hover {color: white!important; border: 2px solid #CCC!important}
.MathJax_Hover_Arrow:hover span {background-color: #CCC!important}
</style><style type="text/css">#MathJax_About {position: fixed; left: 50%; width: auto; text-align: center; border: 3px outset; padding: 1em 2em; background-color: #DDDDDD; color: black; cursor: default; font-family: message-box; font-size: 120%; font-style: normal; text-indent: 0; text-transform: none; line-height: normal; letter-spacing: normal; word-spacing: normal; word-wrap: normal; white-space: nowrap; float: none; z-index: 201; border-radius: 15px; -webkit-border-radius: 15px; -moz-border-radius: 15px; -khtml-border-radius: 15px; box-shadow: 0px 10px 20px #808080; -webkit-box-shadow: 0px 10px 20px #808080; -moz-box-shadow: 0px 10px 20px #808080; -khtml-box-shadow: 0px 10px 20px #808080; filter: progid:DXImageTransform.Microsoft.dropshadow(OffX=2, OffY=2, Color='gray', Positive='true')}
#MathJax_About.MathJax_MousePost {outline: none}
.MathJax_Menu {position: absolute; background-color: white; color: black; width: auto; padding: 2px; border: 1px solid #CCCCCC; margin: 0; cursor: default; font: menu; text-align: left; text-indent: 0; text-transform: none; line-height: normal; letter-spacing: normal; word-spacing: normal; word-wrap: normal; white-space: nowrap; float: none; z-index: 201; box-shadow: 0px 10px 20px #808080; -webkit-box-shadow: 0px 10px 20px #808080; -moz-box-shadow: 0px 10px 20px #808080; -khtml-box-shadow: 0px 10px 20px #808080; filter: progid:DXImageTransform.Microsoft.dropshadow(OffX=2, OffY=2, Color='gray', Positive='true')}
.MathJax_MenuItem {padding: 2px 2em; background: transparent}
.MathJax_MenuArrow {position: absolute; right: .5em; padding-top: .25em; color: #666666; font-size: .75em}
.MathJax_MenuActive .MathJax_MenuArrow {color: white}
.MathJax_MenuArrow.RTL {left: .5em; right: auto}
.MathJax_MenuCheck {position: absolute; left: .7em}
.MathJax_MenuCheck.RTL {right: .7em; left: auto}
.MathJax_MenuRadioCheck {position: absolute; left: 1em}
.MathJax_MenuRadioCheck.RTL {right: 1em; left: auto}
.MathJax_MenuLabel {padding: 2px 2em 4px 1.33em; font-style: italic}
.MathJax_MenuRule {border-top: 1px solid #CCCCCC; margin: 4px 1px 0px}
.MathJax_MenuDisabled {color: GrayText}
.MathJax_MenuActive {background-color: Highlight; color: HighlightText}
.MathJax_MenuDisabled:focus, .MathJax_MenuLabel:focus {background-color: #E8E8E8}
.MathJax_ContextMenu:focus {outline: none}
.MathJax_ContextMenu .MathJax_MenuItem:focus {outline: none}
#MathJax_AboutClose {top: .2em; right: .2em}
.MathJax_Menu .MathJax_MenuClose {top: -10px; left: -10px}
.MathJax_MenuClose {position: absolute; cursor: pointer; display: inline-block; border: 2px solid #AAA; border-radius: 18px; -webkit-border-radius: 18px; -moz-border-radius: 18px; -khtml-border-radius: 18px; font-family: 'Courier New',Courier; font-size: 24px; color: #F0F0F0}
.MathJax_MenuClose span {display: block; background-color: #AAA; border: 1.5px solid; border-radius: 18px; -webkit-border-radius: 18px; -moz-border-radius: 18px; -khtml-border-radius: 18px; line-height: 0; padding: 8px 0 6px}
.MathJax_MenuClose:hover {color: white!important; border: 2px solid #CCC!important}
.MathJax_MenuClose:hover span {background-color: #CCC!important}
.MathJax_MenuClose:hover:focus {outline: none}
</style><style type="text/css">.MathJax_Preview .MJXf-math {color: inherit!important}
</style><style type="text/css">.MJX_Assistive_MathML {position: absolute!important; top: 0; left: 0; clip: rect(1px, 1px, 1px, 1px); padding: 1px 0 0 0!important; border: 0!important; height: 1px!important; width: 1px!important; overflow: hidden!important; display: block!important; -webkit-touch-callout: none; -webkit-user-select: none; -khtml-user-select: none; -moz-user-select: none; -ms-user-select: none; user-select: none}
.MJX_Assistive_MathML.MJX_Assistive_MathML_Block {width: 100%!important}
</style><style type="text/css">#MathJax_Zoom {position: absolute; background-color: #F0F0F0; overflow: auto; display: block; z-index: 301; padding: .5em; border: 1px solid black; margin: 0; font-weight: normal; font-style: normal; text-align: left; text-indent: 0; text-transform: none; line-height: normal; letter-spacing: normal; word-spacing: normal; word-wrap: normal; white-space: nowrap; float: none; -webkit-box-sizing: content-box; -moz-box-sizing: content-box; box-sizing: content-box; box-shadow: 5px 5px 15px #AAAAAA; -webkit-box-shadow: 5px 5px 15px #AAAAAA; -moz-box-shadow: 5px 5px 15px #AAAAAA; -khtml-box-shadow: 5px 5px 15px #AAAAAA; filter: progid:DXImageTransform.Microsoft.dropshadow(OffX=2, OffY=2, Color='gray', Positive='true')}
#MathJax_ZoomOverlay {position: absolute; left: 0; top: 0; z-index: 300; display: inline-block; width: 100%; height: 100%; border: 0; padding: 0; margin: 0; background-color: white; opacity: 0; filter: alpha(opacity=0)}
#MathJax_ZoomFrame {position: relative; display: inline-block; height: 0; width: 0}
#MathJax_ZoomEventTrap {position: absolute; left: 0; top: 0; z-index: 302; display: inline-block; border: 0; padding: 0; margin: 0; background-color: white; opacity: 0; filter: alpha(opacity=0)}
</style><style type="text/css">.MathJax_Preview {color: #888}
#MathJax_Message {position: fixed; left: 1em; bottom: 1.5em; background-color: #E6E6E6; border: 1px solid #959595; margin: 0px; padding: 2px 8px; z-index: 102; color: black; font-size: 80%; width: auto; white-space: nowrap}
#MathJax_MSIE_Frame {position: absolute; top: 0; left: 0; width: 0px; z-index: 101; border: 0px; margin: 0px; padding: 0px}
.MathJax_Error {color: #CC0000; font-style: italic}
</style><style type="text/css">.MJXp-script {font-size: .8em}
.MJXp-right {-webkit-transform-origin: right; -moz-transform-origin: right; -ms-transform-origin: right; -o-transform-origin: right; transform-origin: right}
.MJXp-bold {font-weight: bold}
.MJXp-italic {font-style: italic}
.MJXp-scr {font-family: MathJax_Script,'Times New Roman',Times,STIXGeneral,serif}
.MJXp-frak {font-family: MathJax_Fraktur,'Times New Roman',Times,STIXGeneral,serif}
.MJXp-sf {font-family: MathJax_SansSerif,'Times New Roman',Times,STIXGeneral,serif}
.MJXp-cal {font-family: MathJax_Caligraphic,'Times New Roman',Times,STIXGeneral,serif}
.MJXp-mono {font-family: MathJax_Typewriter,'Times New Roman',Times,STIXGeneral,serif}
.MJXp-largeop {font-size: 150%}
.MJXp-largeop.MJXp-int {vertical-align: -.2em}
.MJXp-math {display: inline-block; line-height: 1.2; text-indent: 0; font-family: 'Times New Roman',Times,STIXGeneral,serif; white-space: nowrap; border-collapse: collapse}
.MJXp-display {display: block; text-align: center; margin: 1em 0}
.MJXp-math span {display: inline-block}
.MJXp-box {display: block!important; text-align: center}
.MJXp-box:after {content: " "}
.MJXp-rule {display: block!important; margin-top: .1em}
.MJXp-char {display: block!important}
.MJXp-mo {margin: 0 .15em}
.MJXp-mfrac {margin: 0 .125em; vertical-align: .25em}
.MJXp-denom {display: inline-table!important; width: 100%}
.MJXp-denom > * {display: table-row!important}
.MJXp-surd {vertical-align: top}
.MJXp-surd > * {display: block!important}
.MJXp-script-box > *  {display: table!important; height: 50%}
.MJXp-script-box > * > * {display: table-cell!important; vertical-align: top}
.MJXp-script-box > *:last-child > * {vertical-align: bottom}
.MJXp-script-box > * > * > * {display: block!important}
.MJXp-mphantom {visibility: hidden}
.MJXp-munderover {display: inline-table!important}
.MJXp-over {display: inline-block!important; text-align: center}
.MJXp-over > * {display: block!important}
.MJXp-munderover > * {display: table-row!important}
.MJXp-mtable {vertical-align: .25em; margin: 0 .125em}
.MJXp-mtable > * {display: inline-table!important; vertical-align: middle}
.MJXp-mtr {display: table-row!important}
.MJXp-mtd {display: table-cell!important; text-align: center; padding: .5em 0 0 .5em}
.MJXp-mtr > .MJXp-mtd:first-child {padding-left: 0}
.MJXp-mtr:first-child > .MJXp-mtd {padding-top: 0}
.MJXp-mlabeledtr {display: table-row!important}
.MJXp-mlabeledtr > .MJXp-mtd:first-child {padding-left: 0}
.MJXp-mlabeledtr:first-child > .MJXp-mtd {padding-top: 0}
.MJXp-merror {background-color: #FFFF88; color: #CC0000; border: 1px solid #CC0000; padding: 1px 3px; font-style: normal; font-size: 90%}
.MJXp-scale0 {-webkit-transform: scaleX(.0); -moz-transform: scaleX(.0); -ms-transform: scaleX(.0); -o-transform: scaleX(.0); transform: scaleX(.0)}
.MJXp-scale1 {-webkit-transform: scaleX(.1); -moz-transform: scaleX(.1); -ms-transform: scaleX(.1); -o-transform: scaleX(.1); transform: scaleX(.1)}
.MJXp-scale2 {-webkit-transform: scaleX(.2); -moz-transform: scaleX(.2); -ms-transform: scaleX(.2); -o-transform: scaleX(.2); transform: scaleX(.2)}
.MJXp-scale3 {-webkit-transform: scaleX(.3); -moz-transform: scaleX(.3); -ms-transform: scaleX(.3); -o-transform: scaleX(.3); transform: scaleX(.3)}
.MJXp-scale4 {-webkit-transform: scaleX(.4); -moz-transform: scaleX(.4); -ms-transform: scaleX(.4); -o-transform: scaleX(.4); transform: scaleX(.4)}
.MJXp-scale5 {-webkit-transform: scaleX(.5); -moz-transform: scaleX(.5); -ms-transform: scaleX(.5); -o-transform: scaleX(.5); transform: scaleX(.5)}
.MJXp-scale6 {-webkit-transform: scaleX(.6); -moz-transform: scaleX(.6); -ms-transform: scaleX(.6); -o-transform: scaleX(.6); transform: scaleX(.6)}
.MJXp-scale7 {-webkit-transform: scaleX(.7); -moz-transform: scaleX(.7); -ms-transform: scaleX(.7); -o-transform: scaleX(.7); transform: scaleX(.7)}
.MJXp-scale8 {-webkit-transform: scaleX(.8); -moz-transform: scaleX(.8); -ms-transform: scaleX(.8); -o-transform: scaleX(.8); transform: scaleX(.8)}
.MJXp-scale9 {-webkit-transform: scaleX(.9); -moz-transform: scaleX(.9); -ms-transform: scaleX(.9); -o-transform: scaleX(.9); transform: scaleX(.9)}
.MathJax_PHTML .noError {vertical-align: ; font-size: 90%; text-align: left; color: black; padding: 1px 3px; border: 1px solid}
</style><style type="text/css">.MathJax_Display {text-align: center; margin: 1em 0em; position: relative; display: block!important; text-indent: 0; max-width: none; max-height: none; min-width: 0; min-height: 0; width: 100%}
.MathJax .merror {background-color: #FFFF88; color: #CC0000; border: 1px solid #CC0000; padding: 1px 3px; font-style: normal; font-size: 90%}
.MathJax .MJX-monospace {font-family: monospace}
.MathJax .MJX-sans-serif {font-family: sans-serif}
#MathJax_Tooltip {background-color: InfoBackground; color: InfoText; border: 1px solid black; box-shadow: 2px 2px 5px #AAAAAA; -webkit-box-shadow: 2px 2px 5px #AAAAAA; -moz-box-shadow: 2px 2px 5px #AAAAAA; -khtml-box-shadow: 2px 2px 5px #AAAAAA; filter: progid:DXImageTransform.Microsoft.dropshadow(OffX=2, OffY=2, Color='gray', Positive='true'); padding: 3px 4px; z-index: 401; position: absolute; left: 0; top: 0; width: auto; height: auto; display: none}
.MathJax {display: inline; font-style: normal; font-weight: normal; line-height: normal; font-size: 100%; font-size-adjust: none; text-indent: 0; text-align: left; text-transform: none; letter-spacing: normal; word-spacing: normal; word-wrap: normal; white-space: nowrap; float: none; direction: ltr; max-width: none; max-height: none; min-width: 0; min-height: 0; border: 0; padding: 0; margin: 0}
.MathJax:focus, body :focus .MathJax {display: inline-table}
.MathJax.MathJax_FullWidth {text-align: center; display: table-cell!important; width: 10000em!important}
.MathJax img, .MathJax nobr, .MathJax a {border: 0; padding: 0; margin: 0; max-width: none; max-height: none; min-width: 0; min-height: 0; vertical-align: 0; line-height: normal; text-decoration: none}
img.MathJax_strut {border: 0!important; padding: 0!important; margin: 0!important; vertical-align: 0!important}
.MathJax span {display: inline; position: static; border: 0; padding: 0; margin: 0; vertical-align: 0; line-height: normal; text-decoration: none}
.MathJax nobr {white-space: nowrap!important}
.MathJax img {display: inline!important; float: none!important}
.MathJax * {transition: none; -webkit-transition: none; -moz-transition: none; -ms-transition: none; -o-transition: none}
.MathJax_Processing {visibility: hidden; position: fixed; width: 0; height: 0; overflow: hidden}
.MathJax_Processed {display: none!important}
.MathJax_ExBox {display: block!important; overflow: hidden; width: 1px; height: 60ex; min-height: 0; max-height: none}
.MathJax .MathJax_EmBox {display: block!important; overflow: hidden; width: 1px; height: 60em; min-height: 0; max-height: none}
.MathJax_LineBox {display: table!important}
.MathJax_LineBox span {display: table-cell!important; width: 10000em!important; min-width: 0; max-width: none; padding: 0; border: 0; margin: 0}
.MathJax .MathJax_HitBox {cursor: text; background: white; opacity: 0; filter: alpha(opacity=0)}
.MathJax .MathJax_HitBox * {filter: none; opacity: 1; background: transparent}
#MathJax_Tooltip * {filter: none; opacity: 1; background: transparent}
@font-face {font-family: MathJax_Main; src: url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/fonts/HTML-CSS/TeX/woff/MathJax_Main-Regular.woff?V=2.7.1') format('woff'), url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/fonts/HTML-CSS/TeX/otf/MathJax_Main-Regular.otf?V=2.7.1') format('opentype')}
@font-face {font-family: MathJax_Main-bold; src: url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/fonts/HTML-CSS/TeX/woff/MathJax_Main-Bold.woff?V=2.7.1') format('woff'), url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/fonts/HTML-CSS/TeX/otf/MathJax_Main-Bold.otf?V=2.7.1') format('opentype')}
@font-face {font-family: MathJax_Main-italic; src: url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/fonts/HTML-CSS/TeX/woff/MathJax_Main-Italic.woff?V=2.7.1') format('woff'), url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/fonts/HTML-CSS/TeX/otf/MathJax_Main-Italic.otf?V=2.7.1') format('opentype')}
@font-face {font-family: MathJax_Math-italic; src: url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/fonts/HTML-CSS/TeX/woff/MathJax_Math-Italic.woff?V=2.7.1') format('woff'), url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/fonts/HTML-CSS/TeX/otf/MathJax_Math-Italic.otf?V=2.7.1') format('opentype')}
@font-face {font-family: MathJax_Caligraphic; src: url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/fonts/HTML-CSS/TeX/woff/MathJax_Caligraphic-Regular.woff?V=2.7.1') format('woff'), url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/fonts/HTML-CSS/TeX/otf/MathJax_Caligraphic-Regular.otf?V=2.7.1') format('opentype')}
@font-face {font-family: MathJax_Size1; src: url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/fonts/HTML-CSS/TeX/woff/MathJax_Size1-Regular.woff?V=2.7.1') format('woff'), url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/fonts/HTML-CSS/TeX/otf/MathJax_Size1-Regular.otf?V=2.7.1') format('opentype')}
@font-face {font-family: MathJax_Size2; src: url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/fonts/HTML-CSS/TeX/woff/MathJax_Size2-Regular.woff?V=2.7.1') format('woff'), url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/fonts/HTML-CSS/TeX/otf/MathJax_Size2-Regular.otf?V=2.7.1') format('opentype')}
@font-face {font-family: MathJax_Size3; src: url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/fonts/HTML-CSS/TeX/woff/MathJax_Size3-Regular.woff?V=2.7.1') format('woff'), url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/fonts/HTML-CSS/TeX/otf/MathJax_Size3-Regular.otf?V=2.7.1') format('opentype')}
@font-face {font-family: MathJax_Size4; src: url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/fonts/HTML-CSS/TeX/woff/MathJax_Size4-Regular.woff?V=2.7.1') format('woff'), url('https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/fonts/HTML-CSS/TeX/otf/MathJax_Size4-Regular.otf?V=2.7.1') format('opentype')}
.MathJax .noError {vertical-align: ; font-size: 90%; text-align: left; color: black; padding: 1px 3px; border: 1px solid}
</style></head>


    <body><div style="visibility: hidden; overflow: hidden; position: absolute; top: 0px; height: 1px; width: auto; padding: 0px; border: 0px; margin: 0px; text-align: left; text-indent: 0px; text-transform: none; line-height: normal; letter-spacing: normal; word-spacing: normal;"><div id="MathJax_Hidden"></div></div><div id="MathJax_Message" style="display: none;"></div>

    <header class="site-header">

  <div class="wrap title-wrap">
    <a class="site-title" href="https://dlunizg.github.io/">Stranice predmeta Duboko učenje (FER)</a>
  </div>

</header>


    <div class="page-content">
      <div class="wrap">
      <div class="post">

<!--
  <header class="post-header">
    <h1>vježba: modeliranje nizova povratnim neuronskim mrežama</h1>
  </header>
-->

  <article class="post-content">
  <h2 id="3-vježba-modeliranje-nizova-povratnim-neuronskim-mrežama">3. vježba: modeliranje nizova povratnim neuronskim mrežama</h2>

<p>U trećoj laboratorijskoj vježbi bavimo se povratnim neuronskim mrežama i problemom modeliranja jezika na razini slova.</p>

<p>Kao što su konvolucijske neuronske mreže arhitektura specijalizirana za obrađivanje slika kroz iterativno povećavajuće lokalne filtre, povratne neuronske mreže su arhitektura specijalizirana za obrađivanje nizova podataka u smjeru jedne dimenzije (simuliranje protoka vremena). Intuitivan i motivirajuć primjer ovoga je tekst, u kojemu možemo zamisliti trenutni smisao rečenice kao funkciju svih dosadašnjih riječi, te za slučaj jezika europskog podrijetla - možemo pretpostaviti da se trenutni smisao mijenja od početka rečenice prema kraju, u smjeru s lijeva na desno.</p>

<p>Glavna prednost povratnih neuronskih mreža ne nalazi se u obrađivanju postojećih nizova, već u generiranju novih slijedova na temelju naučene reprezentacije u skrivenom sloju ili na temelju naučenih parametara mreže. Slijedovi generirani (i obrađivani) pomoću povratnih neuronskih mreža mogu imati varijabilnu duljinu, za razliku od generiranja slika pomoću konvolucijskih mreža, u kojima dimenzije izlaza (generirane slike) moraju biti unaprijed poznate. U zadnje vrijeme adaptacije konvolucijskih slojeva i mreža za projekciju podataka varijabilne duljine u reprezentaciju skrivenog sloja uzimaju maha te konkuriraju povratnim modelima, no generiranje je još u domeni povratnih mreža.</p>

<p>Statističko modeliranje jezika je problem aproksimacije vjerojatnosne distribucije preko niza riječi. Za zadani niz riječi <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-1-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;bold&quot;&gt;w&lt;/mi&gt;&lt;/mrow&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1" style="width: 1.044em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.836em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.565em, 1000.84em, 2.346em, -999.997em); top: -2.185em; left: 0em;"><span class="mrow" id="MathJax-Span-2"><span class="texatom" id="MathJax-Span-3"><span class="mrow" id="MathJax-Span-4"><span class="mi" id="MathJax-Span-5" style="font-family: MathJax_Main-bold;">w</span></span></span></span><span style="display: inline-block; width: 0px; height: 2.19em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.691em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="bold">w</mi></mrow></math></span></span><script type="math/tex" id="MathJax-Element-1">\mathbf{w}</script> <em>“The quick brown fox jumped”</em> duljine <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-2-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mn&gt;5&lt;/mn&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-6" style="width: 2.919em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.398em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.357em, 1002.35em, 2.346em, -999.997em); top: -2.185em; left: 0em;"><span class="mrow" id="MathJax-Span-7"><span class="mi" id="MathJax-Span-8" style="font-family: MathJax_Math-italic;">n</span><span class="mo" id="MathJax-Span-9" style="font-family: MathJax_Main; padding-left: 0.263em;">=</span><span class="mn" id="MathJax-Span-10" style="font-family: MathJax_Main; padding-left: 0.263em;">5</span></span><span style="display: inline-block; width: 0px; height: 2.19em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.941em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>n</mi><mo>=</mo><mn>5</mn></math></span></span><script type="math/tex" id="MathJax-Element-2">n = 5</script>, jezični model pridodaje vjerojatnost <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-3-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;P&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;bold&quot;&gt;w&lt;/mi&gt;&lt;/mrow&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mi&gt;P&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;w&lt;/mi&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/msub&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mo&gt;&amp;#x2026;&lt;/mo&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;msub&gt;&lt;mi&gt;w&lt;/mi&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-11" style="width: 11.565em; display: inline-block;"><span style="display: inline-block; position: relative; width: 9.638em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.357em, 1009.53em, 2.659em, -999.997em); top: -2.237em; left: 0em;"><span class="mrow" id="MathJax-Span-12"><span class="mi" id="MathJax-Span-13" style="font-family: MathJax_Math-italic;">P<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.107em;"></span></span><span class="mo" id="MathJax-Span-14" style="font-family: MathJax_Main;">(</span><span class="texatom" id="MathJax-Span-15"><span class="mrow" id="MathJax-Span-16"><span class="mi" id="MathJax-Span-17" style="font-family: MathJax_Main-bold;">w</span></span></span><span class="mo" id="MathJax-Span-18" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-19" style="font-family: MathJax_Main; padding-left: 0.263em;">=</span><span class="mi" id="MathJax-Span-20" style="font-family: MathJax_Math-italic; padding-left: 0.263em;">P<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.107em;"></span></span><span class="mo" id="MathJax-Span-21" style="font-family: MathJax_Main;">(</span><span class="msubsup" id="MathJax-Span-22"><span style="display: inline-block; position: relative; width: 1.148em; height: 0px;"><span style="position: absolute; clip: rect(3.388em, 1000.68em, 4.169em, -999.997em); top: -4.008em; left: 0em;"><span class="mi" id="MathJax-Span-23" style="font-family: MathJax_Math-italic;">w</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; top: -3.852em; left: 0.732em;"><span class="mn" id="MathJax-Span-24" style="font-size: 70.7%; font-family: MathJax_Main;">1</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span></span><span class="mo" id="MathJax-Span-25" style="font-family: MathJax_Main;">,</span><span class="mo" id="MathJax-Span-26" style="font-family: MathJax_Main; padding-left: 0.159em;">…</span><span class="mo" id="MathJax-Span-27" style="font-family: MathJax_Main; padding-left: 0.159em;">,</span><span class="msubsup" id="MathJax-Span-28" style="padding-left: 0.159em;"><span style="display: inline-block; position: relative; width: 1.201em; height: 0px;"><span style="position: absolute; clip: rect(3.388em, 1000.68em, 4.169em, -999.997em); top: -4.008em; left: 0em;"><span class="mi" id="MathJax-Span-29" style="font-family: MathJax_Math-italic;">w</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; top: -3.852em; left: 0.732em;"><span class="mi" id="MathJax-Span-30" style="font-size: 70.7%; font-family: MathJax_Math-italic;">n</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span></span><span class="mo" id="MathJax-Span-31" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.242em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.372em; border-left: 0px solid; width: 0px; height: 1.316em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>P</mi><mo stretchy="false">(</mo><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="bold">w</mi></mrow><mo stretchy="false">)</mo><mo>=</mo><mi>P</mi><mo stretchy="false">(</mo><msub><mi>w</mi><mn>1</mn></msub><mo>,</mo><mo>…</mo><mo>,</mo><msub><mi>w</mi><mi>n</mi></msub><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-3">P(\mathbf{w}) = P(w_1,…,w_n)</script> tom nizu riječi, koju interpretiramo kao vjerojatnost da se taj niz pojavi u stvarnom jeziku.</p>

<p>Standardni statistički modeli jezika radi izračunljivosti i rijetkosti podataka ne mogu modelirati proizvoljno duge slijedove, te prihvaćaju aproksimaciju prozorom riječi (tzv. kontekst) konstantne duljine. Takvi jezični modeli se zovu modelima n-grama.</p>

<p>Primjerice, za <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-4-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mn&gt;5&lt;/mn&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-32" style="width: 2.919em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.398em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.357em, 1002.35em, 2.346em, -999.997em); top: -2.185em; left: 0em;"><span class="mrow" id="MathJax-Span-33"><span class="mi" id="MathJax-Span-34" style="font-family: MathJax_Math-italic;">n</span><span class="mo" id="MathJax-Span-35" style="font-family: MathJax_Main; padding-left: 0.263em;">=</span><span class="mn" id="MathJax-Span-36" style="font-family: MathJax_Main; padding-left: 0.263em;">5</span></span><span style="display: inline-block; width: 0px; height: 2.19em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.941em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>n</mi><mo>=</mo><mn>5</mn></math></span></span><script type="math/tex" id="MathJax-Element-4">n=5</script> i jezični model 5-grama, vjerojatnost pojavljivanja prethodno navedenog niza bi bila:</p>

<span class="MathJax_Preview" style="color: inherit; display: none;"></span><div class="MathJax_Display"><span class="MathJax MathJax_FullWidth" id="MathJax-Element-5-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;&gt;&lt;mi&gt;P&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;bold&quot;&gt;w&lt;/mi&gt;&lt;/mrow&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mi&gt;P&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;T&lt;/mi&gt;&lt;mi&gt;h&lt;/mi&gt;&lt;mi&gt;e&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mi&gt;P&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;mi&gt;u&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mi&gt;c&lt;/mi&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;|&lt;/mo&gt;&lt;/mrow&gt;&lt;mi&gt;T&lt;/mi&gt;&lt;mi&gt;h&lt;/mi&gt;&lt;mi&gt;e&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mi&gt;P&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;b&lt;/mi&gt;&lt;mi&gt;r&lt;/mi&gt;&lt;mi&gt;o&lt;/mi&gt;&lt;mi&gt;w&lt;/mi&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;|&lt;/mo&gt;&lt;/mrow&gt;&lt;mi&gt;q&lt;/mi&gt;&lt;mi&gt;u&lt;/mi&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mi&gt;c&lt;/mi&gt;&lt;mi&gt;k&lt;/mi&gt;&lt;mo&gt;,&lt;/mo&gt;&lt;mi&gt;T&lt;/mi&gt;&lt;mi&gt;h&lt;/mi&gt;&lt;mi&gt;e&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mo&gt;&amp;#x2026;&lt;/mo&gt;&lt;mspace linebreak=&quot;newline&quot; /&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-37" style="width: 100%; display: inline-block; min-width: 27.815em;"><span style="display: inline-block; position: relative; width: 100%; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(3.128em, 1023.08em, 5.367em, -999.997em); top: -4.008em; left: 0em; width: 100%;"><span class="mrow" id="MathJax-Span-38"><span style="display: inline-block; position: relative; width: 100%; height: 0px;"><span style="position: absolute; clip: rect(3.128em, 1023.08em, 4.43em, -999.997em); top: -4.008em; left: 50%; margin-left: -11.56em;"><span class="mi" id="MathJax-Span-39" style="font-family: MathJax_Math-italic;">P<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.107em;"></span></span><span class="mo" id="MathJax-Span-40" style="font-family: MathJax_Main;">(</span><span class="texatom" id="MathJax-Span-41"><span class="mrow" id="MathJax-Span-42"><span class="mi" id="MathJax-Span-43" style="font-family: MathJax_Main-bold;">w</span></span></span><span class="mo" id="MathJax-Span-44" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-45" style="font-family: MathJax_Main; padding-left: 0.263em;">=</span><span class="mi" id="MathJax-Span-46" style="font-family: MathJax_Math-italic; padding-left: 0.263em;">P<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.107em;"></span></span><span class="mo" id="MathJax-Span-47" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-48" style="font-family: MathJax_Math-italic;">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.107em;"></span></span><span class="mi" id="MathJax-Span-49" style="font-family: MathJax_Math-italic;">h</span><span class="mi" id="MathJax-Span-50" style="font-family: MathJax_Math-italic;">e</span><span class="mo" id="MathJax-Span-51" style="font-family: MathJax_Main;">)</span><span class="mi" id="MathJax-Span-52" style="font-family: MathJax_Math-italic;">P<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.107em;"></span></span><span class="mo" id="MathJax-Span-53" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-54" style="font-family: MathJax_Math-italic;">q<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mi" id="MathJax-Span-55" style="font-family: MathJax_Math-italic;">u</span><span class="mi" id="MathJax-Span-56" style="font-family: MathJax_Math-italic;">i</span><span class="mi" id="MathJax-Span-57" style="font-family: MathJax_Math-italic;">c</span><span class="mi" id="MathJax-Span-58" style="font-family: MathJax_Math-italic;">k</span><span class="texatom" id="MathJax-Span-59"><span class="mrow" id="MathJax-Span-60"><span class="mo" id="MathJax-Span-61" style="font-family: MathJax_Main;">|</span></span></span><span class="mi" id="MathJax-Span-62" style="font-family: MathJax_Math-italic;">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.107em;"></span></span><span class="mi" id="MathJax-Span-63" style="font-family: MathJax_Math-italic;">h</span><span class="mi" id="MathJax-Span-64" style="font-family: MathJax_Math-italic;">e</span><span class="mo" id="MathJax-Span-65" style="font-family: MathJax_Main;">)</span><span class="mi" id="MathJax-Span-66" style="font-family: MathJax_Math-italic;">P<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.107em;"></span></span><span class="mo" id="MathJax-Span-67" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-68" style="font-family: MathJax_Math-italic;">b</span><span class="mi" id="MathJax-Span-69" style="font-family: MathJax_Math-italic;">r</span><span class="mi" id="MathJax-Span-70" style="font-family: MathJax_Math-italic;">o</span><span class="mi" id="MathJax-Span-71" style="font-family: MathJax_Math-italic;">w</span><span class="mi" id="MathJax-Span-72" style="font-family: MathJax_Math-italic;">n</span><span class="texatom" id="MathJax-Span-73"><span class="mrow" id="MathJax-Span-74"><span class="mo" id="MathJax-Span-75" style="font-family: MathJax_Main;">|</span></span></span><span class="mi" id="MathJax-Span-76" style="font-family: MathJax_Math-italic;">q<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mi" id="MathJax-Span-77" style="font-family: MathJax_Math-italic;">u</span><span class="mi" id="MathJax-Span-78" style="font-family: MathJax_Math-italic;">i</span><span class="mi" id="MathJax-Span-79" style="font-family: MathJax_Math-italic;">c</span><span class="mi" id="MathJax-Span-80" style="font-family: MathJax_Math-italic;">k</span><span class="mo" id="MathJax-Span-81" style="font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-82" style="font-family: MathJax_Math-italic; padding-left: 0.159em;">T<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.107em;"></span></span><span class="mi" id="MathJax-Span-83" style="font-family: MathJax_Math-italic;">h</span><span class="mi" id="MathJax-Span-84" style="font-family: MathJax_Math-italic;">e</span><span class="mo" id="MathJax-Span-85" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-86" style="font-family: MathJax_Main; padding-left: 0.159em;">…</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; clip: rect(3.857em, 1000em, 4.169em, -999.997em); top: -2.81em; left: 50%; margin-left: 0em;"><span class="mspace" id="MathJax-Span-87" style="height: 0em; vertical-align: 0em; width: 0em; display: inline-block; overflow: hidden;"></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -1.497em; border-left: 0px solid; width: 0px; height: 2.441em;"></span></span></nobr><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mi>P</mi><mo stretchy="false">(</mo><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="bold">w</mi></mrow><mo stretchy="false">)</mo><mo>=</mo><mi>P</mi><mo stretchy="false">(</mo><mi>T</mi><mi>h</mi><mi>e</mi><mo stretchy="false">)</mo><mi>P</mi><mo stretchy="false">(</mo><mi>q</mi><mi>u</mi><mi>i</mi><mi>c</mi><mi>k</mi><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow><mi>T</mi><mi>h</mi><mi>e</mi><mo stretchy="false">)</mo><mi>P</mi><mo stretchy="false">(</mo><mi>b</mi><mi>r</mi><mi>o</mi><mi>w</mi><mi>n</mi><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">|</mo></mrow><mi>q</mi><mi>u</mi><mi>i</mi><mi>c</mi><mi>k</mi><mo>,</mo><mi>T</mi><mi>h</mi><mi>e</mi><mo stretchy="false">)</mo><mo>…</mo><mspace linebreak="newline"></mspace></math></span></span></div><script type="math/tex; mode=display" id="MathJax-Element-5">P(\mathbf{w}) = P(The)P(quick|The)P(brown|quick,The)\ldots \\</script>

<p>Kao što možemo primjetiti, jezični modeli poput navedenog čuvaju kontekst samo unutar kratkog prozora od pet riječi teško pamte dulje veze unutar teksta. Usprokos tome, jezični modeli bazirani na n-gramima (5-gramima) su bili state-of-the-art do pred par godina.</p>

<p>Povratne neuronske mreže su problemima izračunljivosti i rijetkosti doskočile s dvije optimizacije - prva od njih je čuvanje pomičnog prosjeka <em>(engl. running average)</em> dosadašnjeg niza riječi u skrivenom sloju, dok je druga korištenje projekcije riječi u tzv. ugnježđeni (engl. embedding) sloj.</p>

<h3 id="skup-podataka-cornell-moviedialogs-corpus">Skup podataka: Cornell Movie–Dialogs Corpus</h3>

<p>Zadatak u laboratorijskoj vježbi je naučiti jezični model na domeni dijaloga iz filmova. Originalni skup podataka možete skinuti <a href="https://www.cs.cornell.edu/~cristian/Cornell_Movie-Dialogs_Corpus.html">ovdje</a>, dok je verzija koju ćete koristiti u laboratorijskoj vježbi podskup ukupnog dataseta. Primjeri filmova iz podskupa su u nastavku:</p>

<p align="center">
<img src="./vježba_ modeliranje nizova povratnim neuronskim mrežama_files/movie_covers.png" width="50%">
</p>

<p>Primjer teksta dijaloga iz filmova u formatu iz skupa podataka:</p>

<blockquote>
  <p><strong>ICE:</strong><br>
You’re a hell of a flyer.  You can be my wingman any time.</p>

  <p><strong>MAVERICK:</strong><br>
No. You can be mine</p>
</blockquote>

<p>Svi razgovori u skupu podataka će pratiti navedeni format - ime osobe napisano tiskanim slovima praćeno s dvotočkom i simbolom novog reda, te tekst koji 
osoba izgovara praćen s dva simbola novog reda. Dijalozi različitih filmova i scena nisu odvojeni na poseban način.</p>

<p>Uz podskup skupa podataka dostupna je i skripta <code class="highlighter-rouge">select_preprocess.py</code> koja iz cijelog skupa podataka odabire podskup naslova naveden u kontrolnoj tekstualnoj datoteci, te odrađuje predprocesiranje i zapisivanje dijaloga iz podskupa naslova. Skriptu možete naći <a href="https://github.com/dlunizg/dlunizg.github.io/tree/master/code/lab3">ovdje</a>.</p>

<p>Predprocesiranje koje se provodi nad podacima je odbacivanje svih znakova osim alfanumeričkih te interpunkcije. Znakovi koji ostaju nakon predprocesiranja su:</p>

<blockquote>
  <p>! ‘ , . ` : ? 0 1 2 3 4 5 6 7 8 9 A B C D E F G H I J K L M N O P Q R S T U V W X Y Z a b c d e f g h i j k l m n o p q r s t u v w x y z</p>
</blockquote>

<p>te razmak i znak novog reda.</p>

<h3 id="zadatak-1-učitavanje-podataka-i-batching">Zadatak 1: učitavanje podataka i batching</h3>

<p>Prvi zadatak u laboratorijskoj vježbi je modul za učitavanje tekstualnog skupa podataka te njegova podjela u <em>minibatcheve</em>. Razred za učivavanje skupa podataka implementirajte i spremite u datoteku pod nazivom <code class="highlighter-rouge">dataset.py</code>. Imenovanje samog razreda i metoda ostavljamo vama na izbor.</p>

<p>Modul kao argumente prima lokaciju skupa podataka na disku (datoteka u <code class="highlighter-rouge">txt</code> formatu), veličinu minibatcha te duljinu niza podataka (broj koraka koji se povratna mreža odmata). Modul se može podijeliti u tri konceptualna dijela:</p>

<h4 id="11-predprocesiranje-podataka">1.1: Predprocesiranje podataka</h4>

<p>Kako bi mogli koristiti tekstualne podatke u povratnim neuronskim mrežama, nužno je obaviti njihovo mapiranje u prostor projeva (u ovom slučaju diskretni). To ćemo napraviti tako da svakom znaku dodijelimo jedan broj (idenifikator - <em>id</em>). U praksi, id-jevi se tekstualnim podacima dodijeljuju po principu “češći je manji”, tj. znakovi (ili riječi) koje su češće imaju niži id.</p>

<p>Za predprocesiranje podataka potrebno je implementirati funkciju koja za zadani tekst računa mapiranja (slovo - id) po principu “češći je manji”. Osim toga, potrebno je implementirati funkciju koja zadani proizvoljni niz slova pretvara u niz id-jeva, te funkciju koja zadani proizvoljni niz id-jeva pretvara u niz slova. Kosturi ovih funkcija mogli bi izgledati kao u nastavku:</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># ...</span>
<span class="c"># Code is nested in class definition, indentation is not representative.</span>
<span class="c"># "np" stands for numpy.</span>

<span class="k">def</span> <span class="nf">preprocess</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">input_file</span><span class="p">):</span>
    <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">input_file</span><span class="p">,</span> <span class="s">"r"</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
        <span class="n">data</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">read</span><span class="p">()</span><span class="o">.</span><span class="n">decode</span><span class="p">(</span><span class="s">"utf-8"</span><span class="p">)</span> <span class="c"># python 2</span>

    <span class="c"># count and sort most frequent characters</span>

    <span class="c"># self.sorted chars contains just the characters ordered descending by frequency</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">char2id</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">sorted_chars</span><span class="p">,</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">sorted_chars</span><span class="p">))))</span> 
    <span class="c"># reverse the mapping</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">id2char</span> <span class="o">=</span> <span class="p">{</span><span class="n">k</span><span class="p">:</span><span class="n">v</span> <span class="k">for</span> <span class="n">v</span><span class="p">,</span><span class="n">k</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">char2id</span><span class="o">.</span><span class="n">items</span><span class="p">()}</span>
    <span class="c"># convert the data to ids</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">char2id</span><span class="o">.</span><span class="n">get</span><span class="p">,</span> <span class="n">data</span><span class="p">)))</span>

<span class="k">def</span> <span class="nf">encode</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">sequence</span><span class="p">):</span>
    <span class="c"># returns the sequence encoded as integers</span>
    <span class="k">pass</span>

<span class="k">def</span> <span class="nf">decode</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">encoded_sequence</span><span class="p">):</span>
    <span class="c"># returns the sequence decoded as letters</span>
    <span class="k">pass</span>

<span class="c"># ...</span>
</code></pre></div></div>

<h4 id="12-podjela-u-minibatcheve">1.2: Podjela u minibatcheve</h4>

<p>Pri podjeli u minibatcheve naš skup podataka razdvajamo u parove <code class="highlighter-rouge">x, y</code> veličine <code class="highlighter-rouge">batch_size</code>. No, u ovom slučaju možda nije jasno što nam je <code class="highlighter-rouge">y</code>. U zadatku modeliranja jezika na temelju trenutnog ulaznog znaka i prethodno viđenih znakova pokušavamo predvidjeti <em>idući</em> znak. Prema tome, za ulaz <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-6-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-88" style="width: 1.096em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.888em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.565em, 1000.89em, 2.451em, -999.997em); top: -2.133em; left: 0em;"><span class="mrow" id="MathJax-Span-89"><span class="msubsup" id="MathJax-Span-90"><span style="display: inline-block; position: relative; width: 0.888em; height: 0px;"><span style="position: absolute; clip: rect(3.44em, 1000.52em, 4.169em, -999.997em); top: -4.008em; left: 0em;"><span class="mi" id="MathJax-Span-91" style="font-family: MathJax_Math-italic;">x</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; top: -3.852em; left: 0.576em;"><span class="mi" id="MathJax-Span-92" style="font-size: 70.7%; font-family: MathJax_Math-italic;">t</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.138em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.247em; border-left: 0px solid; width: 0px; height: 0.878em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>x</mi><mi>t</mi></msub></math></span></span><script type="math/tex" id="MathJax-Element-6">x_t</script> naš izlaz <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-7-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mi&gt;y&lt;/mi&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-93" style="width: 1.044em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.836em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.565em, 1000.84em, 2.503em, -999.997em); top: -2.133em; left: 0em;"><span class="mrow" id="MathJax-Span-94"><span class="msubsup" id="MathJax-Span-95"><span style="display: inline-block; position: relative; width: 0.836em; height: 0px;"><span style="position: absolute; clip: rect(3.44em, 1000.52em, 4.378em, -999.997em); top: -4.008em; left: 0em;"><span class="mi" id="MathJax-Span-96" style="font-family: MathJax_Math-italic;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; top: -3.852em; left: 0.471em;"><span class="mi" id="MathJax-Span-97" style="font-size: 70.7%; font-family: MathJax_Math-italic;">t</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.138em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 0.878em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>y</mi><mi>t</mi></msub></math></span></span><script type="math/tex" id="MathJax-Element-7">y_t</script> koji pokušavamo predvidjeti je upravo <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-8-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msub&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;/msub&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-98" style="width: 2.19em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.826em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.565em, 1001.83em, 2.503em, -999.997em); top: -2.133em; left: 0em;"><span class="mrow" id="MathJax-Span-99"><span class="msubsup" id="MathJax-Span-100"><span style="display: inline-block; position: relative; width: 1.826em; height: 0px;"><span style="position: absolute; clip: rect(3.44em, 1000.52em, 4.169em, -999.997em); top: -4.008em; left: 0em;"><span class="mi" id="MathJax-Span-101" style="font-family: MathJax_Math-italic;">x</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; top: -3.852em; left: 0.576em;"><span class="texatom" id="MathJax-Span-102"><span class="mrow" id="MathJax-Span-103"><span class="mi" id="MathJax-Span-104" style="font-size: 70.7%; font-family: MathJax_Math-italic;">t</span><span class="mo" id="MathJax-Span-105" style="font-size: 70.7%; font-family: MathJax_Main;">+</span><span class="mn" id="MathJax-Span-106" style="font-size: 70.7%; font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.138em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 0.878em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub><mi>x</mi><mrow class="MJX-TeXAtom-ORD"><mi>t</mi><mo>+</mo><mn>1</mn></mrow></msub></math></span></span><script type="math/tex" id="MathJax-Element-8">x_{t+1}</script>.</p>

<p>Primjer ovoga vidjljiv je na idućoj slici (preuzeto s <a href="http://karpathy.github.io/2015/05/21/rnn-effectiveness/"><em>“The Unreasonable Effectiveness of Recurrent Neural Networks”</em></a>):</p>

<p align="center">
<img src="./vježba_ modeliranje nizova povratnim neuronskim mrežama_files/charseq.jpeg" width="50%">
</p>

<p>Prema tome, vaš zadatak u ovom koraku je implementirati funkciju koja će na temelju postojećeg dataseta pretvorenog u niz id-jeva taj dataset pretvoriti u niz batcheva veličine <code class="highlighter-rouge">batch_size</code> te duljine <code class="highlighter-rouge">sequence_length</code>. Kostur ove funkcije bi mogao izgledati kao u nastavku:</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># ...</span>
<span class="c"># Code is nested in class definition, indentation is not representative.</span>

<span class="k">def</span> <span class="nf">create_minibatches</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">num_batches</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">x</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">batch_size</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">sequence_length</span><span class="p">))</span> <span class="c"># calculate the number of batches</span>

    <span class="c"># Is all the data going to be present in the batches? Why?</span>
    <span class="c"># What happens if we select a batch size and sequence length larger than the length of the data?</span>

    <span class="c">#######################################</span>
    <span class="c">#       Convert data to batches       #</span>
    <span class="c">#######################################</span>

    <span class="k">pass</span>
</code></pre></div></div>

<p>Način spremanja i reprezentacije batcheva je prepušten vašem izboru.</p>

<h4 id="13-iteracija-po-minibatchevima">1.3: Iteracija po minibatchevima</h4>

<p>Razred za učitavanje skupa podataka treba sadržavati i logiku za iteraciju po batchevima skupa podataka. Pri ovome treba obraćati pozornost na činjenicu da se batchevi ne smiju miješati <em>(engl. shuffle)</em> unutar ni između batcheva, budući da radimo s tekstualnim podacima, te je njihov redoslijed bitan. Prema tome, redoslijed batcheva u svakoj epohi biti će identičan. Kostur ove funkcije bi mogao izgledati kao u nastavku:</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># ...</span>
<span class="c"># Code is nested in class definition, indentation is not representative.</span>
<span class="k">def</span> <span class="nf">next_minibatch</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="c"># ...</span>

    <span class="n">batch_x</span><span class="p">,</span> <span class="n">batch_y</span> <span class="o">=</span> <span class="bp">None</span><span class="p">,</span> <span class="bp">None</span>
    <span class="c"># handling batch pointer &amp; reset</span>
    <span class="c"># new_epoch is a boolean indicating if the batch pointer was reset</span>
    <span class="c"># in this function call</span>
    <span class="k">return</span> <span class="n">new_epoch</span><span class="p">,</span> <span class="n">batch_x</span><span class="p">,</span> <span class="n">batch_y</span>

</code></pre></div></div>

<h3 id="zadatak-2-obična-jednoslojna-povratna-neuronska-mreža">Zadatak 2: obična jednoslojna povratna neuronska mreža</h3>

<p>Kao što smo spomenuli u uvodu laboratorijske vježbe, povratne neuronske mreže su specijalizirane za procesiranje usmjerenih nizova - no još nismo dotaknuli na koji način funkcioniraju. Rad neuronskih mreža najlakše je predočiti s iduća dva grafa:</p>

<p align="center">
<img src="./vježba_ modeliranje nizova povratnim neuronskim mrežama_files/rnn_recurrence.png" width="20%">
<img src="./vježba_ modeliranje nizova povratnim neuronskim mrežama_files/rnn_unrolled.png" width="50%">
</p>

<p>U prvom grafu povratna neuronska mreža je zapisana kompaktno uz povratnu vezu s vremenskim odmakom (crni kvadrat simbolizira korištenje vrijednosti iz prošlog vremenskog koraka), dok je u drugom grafu prikazana tzv. razmotana <em>(engl. unrolled)</em> povratna mreža. Bitna stvar za primjetiti je da su težinske matrice (U, W, V) <strong>neovisne</strong> o vremenskom koraku!</p>

<p>Ovo je primjer ideje dijeljenja parametara prisutne i u konvolucijskim neuronskim mrežama - zahvaljujući kojoj je moguće obrađivati nizove varijabilnih i velikih dužina.</p>

<p>Matematički zapis izraza koji se izvode u grafovima je u nastavku:</p>

<p><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-9-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msup&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;bold&quot;&gt;h&lt;/mi&gt;&lt;/mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;/msup&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mi&gt;n&lt;/mi&gt;&lt;mi&gt;h&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msup&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;bold&quot;&gt;W&lt;/mi&gt;&lt;mi mathvariant=&quot;bold&quot;&gt;h&lt;/mi&gt;&lt;/mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;/msup&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;msup&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;bold&quot;&gt;U&lt;/mi&gt;&lt;mi mathvariant=&quot;bold&quot;&gt;x&lt;/mi&gt;&lt;/mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;/msup&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;bold&quot;&gt;b&lt;/mi&gt;&lt;/mrow&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-107" style="width: 17.659em; display: inline-block;"><span style="display: inline-block; position: relative; width: 14.69em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.148em, 1014.59em, 2.659em, -999.997em); top: -2.237em; left: 0em;"><span class="mrow" id="MathJax-Span-108"><span class="msubsup" id="MathJax-Span-109"><span style="display: inline-block; position: relative; width: 1.513em; height: 0px;"><span style="position: absolute; clip: rect(3.18em, 1000.63em, 4.169em, -999.997em); top: -4.008em; left: 0em;"><span class="texatom" id="MathJax-Span-110"><span class="mrow" id="MathJax-Span-111"><span class="mi" id="MathJax-Span-112" style="font-family: MathJax_Main-bold;">h</span></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; top: -4.424em; left: 0.628em;"><span class="texatom" id="MathJax-Span-113"><span class="mrow" id="MathJax-Span-114"><span class="mo" id="MathJax-Span-115" style="font-size: 70.7%; font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-116" style="font-size: 70.7%; font-family: MathJax_Math-italic;">t</span><span class="mo" id="MathJax-Span-117" style="font-size: 70.7%; font-family: MathJax_Main;">)</span></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span></span><span class="mo" id="MathJax-Span-118" style="font-family: MathJax_Main; padding-left: 0.263em;">=</span><span class="mi" id="MathJax-Span-119" style="font-family: MathJax_Math-italic; padding-left: 0.263em;">t</span><span class="mi" id="MathJax-Span-120" style="font-family: MathJax_Math-italic;">a</span><span class="mi" id="MathJax-Span-121" style="font-family: MathJax_Math-italic;">n</span><span class="mi" id="MathJax-Span-122" style="font-family: MathJax_Math-italic;">h</span><span class="mo" id="MathJax-Span-123" style="font-family: MathJax_Main;">(</span><span class="msubsup" id="MathJax-Span-124"><span style="display: inline-block; position: relative; width: 3.596em; height: 0px;"><span style="position: absolute; clip: rect(3.18em, 1001.83em, 4.169em, -999.997em); top: -4.008em; left: 0em;"><span class="texatom" id="MathJax-Span-125"><span class="mrow" id="MathJax-Span-126"><span class="mi" id="MathJax-Span-127" style="font-family: MathJax_Main-bold;">W</span><span class="mi" id="MathJax-Span-128" style="font-family: MathJax_Main-bold;">h</span></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; top: -4.424em; left: 1.826em;"><span class="texatom" id="MathJax-Span-129"><span class="mrow" id="MathJax-Span-130"><span class="mo" id="MathJax-Span-131" style="font-size: 70.7%; font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-132" style="font-size: 70.7%; font-family: MathJax_Math-italic;">t</span><span class="mo" id="MathJax-Span-133" style="font-size: 70.7%; font-family: MathJax_Main;">−</span><span class="mn" id="MathJax-Span-134" style="font-size: 70.7%; font-family: MathJax_Main;">1</span><span class="mo" id="MathJax-Span-135" style="font-size: 70.7%; font-family: MathJax_Main;">)</span></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span></span><span class="mo" id="MathJax-Span-136" style="font-family: MathJax_Main; padding-left: 0.211em;">+</span><span class="msubsup" id="MathJax-Span-137" style="padding-left: 0.211em;"><span style="display: inline-block; position: relative; width: 2.398em; height: 0px;"><span style="position: absolute; clip: rect(3.18em, 1001.46em, 4.169em, -999.997em); top: -4.008em; left: 0em;"><span class="texatom" id="MathJax-Span-138"><span class="mrow" id="MathJax-Span-139"><span class="mi" id="MathJax-Span-140" style="font-family: MathJax_Main-bold;">U</span><span class="mi" id="MathJax-Span-141" style="font-family: MathJax_Main-bold;">x</span></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; top: -4.424em; left: 1.513em;"><span class="texatom" id="MathJax-Span-142"><span class="mrow" id="MathJax-Span-143"><span class="mo" id="MathJax-Span-144" style="font-size: 70.7%; font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-145" style="font-size: 70.7%; font-family: MathJax_Math-italic;">t</span><span class="mo" id="MathJax-Span-146" style="font-size: 70.7%; font-family: MathJax_Main;">)</span></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span></span><span class="mo" id="MathJax-Span-147" style="font-family: MathJax_Main; padding-left: 0.211em;">+</span><span class="texatom" id="MathJax-Span-148" style="padding-left: 0.211em;"><span class="mrow" id="MathJax-Span-149"><span class="mi" id="MathJax-Span-150" style="font-family: MathJax_Main-bold;">b</span></span></span><span class="mo" id="MathJax-Span-151" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.242em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.372em; border-left: 0px solid; width: 0px; height: 1.566em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msup><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="bold">h</mi></mrow><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">(</mo><mi>t</mi><mo stretchy="false">)</mo></mrow></msup><mo>=</mo><mi>t</mi><mi>a</mi><mi>n</mi><mi>h</mi><mo stretchy="false">(</mo><msup><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="bold">W</mi><mi mathvariant="bold">h</mi></mrow><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">(</mo><mi>t</mi><mo>−</mo><mn>1</mn><mo stretchy="false">)</mo></mrow></msup><mo>+</mo><msup><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="bold">U</mi><mi mathvariant="bold">x</mi></mrow><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">(</mo><mi>t</mi><mo stretchy="false">)</mo></mrow></msup><mo>+</mo><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="bold">b</mi></mrow><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-9">\mathbf{h}^{(t)} = tanh(\mathbf{Wh}^{(t-1)} + \mathbf{Ux}^{(t)} + \mathbf{b})</script>
<br>
<span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-10-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;msup&gt;&lt;mi mathvariant=&quot;bold&quot;&gt;o&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo mathvariant=&quot;bold&quot; stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi mathvariant=&quot;bold&quot;&gt;t&lt;/mi&gt;&lt;mo mathvariant=&quot;bold&quot; stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;/msup&gt;&lt;/mrow&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;msup&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;bold&quot;&gt;V&lt;/mi&gt;&lt;mi mathvariant=&quot;bold&quot;&gt;h&lt;/mi&gt;&lt;/mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;/msup&gt;&lt;mo&gt;+&lt;/mo&gt;&lt;mi&gt;c&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-152" style="width: 8.336em; display: inline-block;"><span style="display: inline-block; position: relative; width: 6.93em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.096em, 1006.93em, 2.451em, -999.997em); top: -2.185em; left: 0em;"><span class="mrow" id="MathJax-Span-153"><span class="texatom" id="MathJax-Span-154"><span class="mrow" id="MathJax-Span-155"><span class="msubsup" id="MathJax-Span-156"><span style="display: inline-block; position: relative; width: 1.617em; height: 0px;"><span style="position: absolute; clip: rect(3.388em, 1000.52em, 4.169em, -999.997em); top: -4.008em; left: 0em;"><span class="mi" id="MathJax-Span-157" style="font-family: MathJax_Main-bold;">o</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; top: -4.372em; left: 0.576em;"><span class="texatom" id="MathJax-Span-158"><span class="mrow" id="MathJax-Span-159"><span class="mo" id="MathJax-Span-160" style="font-size: 70.7%; font-family: MathJax_Main-bold;">(</span><span class="mi" id="MathJax-Span-161" style="font-size: 70.7%; font-family: MathJax_Main-bold;">t</span><span class="mo" id="MathJax-Span-162" style="font-size: 70.7%; font-family: MathJax_Main-bold;">)</span></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span></span></span></span><span class="mo" id="MathJax-Span-163" style="font-family: MathJax_Main; padding-left: 0.263em;">=</span><span class="msubsup" id="MathJax-Span-164" style="padding-left: 0.263em;"><span style="display: inline-block; position: relative; width: 2.398em; height: 0px;"><span style="position: absolute; clip: rect(3.18em, 1001.51em, 4.169em, -999.997em); top: -4.008em; left: 0em;"><span class="texatom" id="MathJax-Span-165"><span class="mrow" id="MathJax-Span-166"><span class="mi" id="MathJax-Span-167" style="font-family: MathJax_Main-bold;">V</span><span class="mi" id="MathJax-Span-168" style="font-family: MathJax_Main-bold;">h</span></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; top: -4.424em; left: 1.513em;"><span class="texatom" id="MathJax-Span-169"><span class="mrow" id="MathJax-Span-170"><span class="mo" id="MathJax-Span-171" style="font-size: 70.7%; font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-172" style="font-size: 70.7%; font-family: MathJax_Math-italic;">t</span><span class="mo" id="MathJax-Span-173" style="font-size: 70.7%; font-family: MathJax_Main;">)</span></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span></span><span class="mo" id="MathJax-Span-174" style="font-family: MathJax_Main; padding-left: 0.211em;">+</span><span class="mi" id="MathJax-Span-175" style="font-family: MathJax_Math-italic; padding-left: 0.211em;">c</span></span><span style="display: inline-block; width: 0px; height: 2.19em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.184em; border-left: 0px solid; width: 0px; height: 1.378em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mrow class="MJX-TeXAtom-ORD"><msup><mi mathvariant="bold">o</mi><mrow class="MJX-TeXAtom-ORD"><mo mathvariant="bold" stretchy="false">(</mo><mi mathvariant="bold">t</mi><mo mathvariant="bold" stretchy="false">)</mo></mrow></msup></mrow><mo>=</mo><msup><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="bold">V</mi><mi mathvariant="bold">h</mi></mrow><mrow class="MJX-TeXAtom-ORD"><mo stretchy="false">(</mo><mi>t</mi><mo stretchy="false">)</mo></mrow></msup><mo>+</mo><mi>c</mi></math></span></span><script type="math/tex" id="MathJax-Element-10">\mathbf{o^{(t)}} = \mathbf{Vh}^{(t)} + c</script>
<br>
<span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-11-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;msup&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mover&gt;&lt;mi mathvariant=&quot;bold&quot;&gt;y&lt;/mi&gt;&lt;mo mathvariant=&quot;bold&quot; stretchy=&quot;false&quot;&gt;&amp;#x005E;&lt;/mo&gt;&lt;/mover&gt;&lt;/mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo mathvariant=&quot;bold&quot; stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi mathvariant=&quot;bold&quot;&gt;t&lt;/mi&gt;&lt;mo mathvariant=&quot;bold&quot; stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;/msup&gt;&lt;/mrow&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mi&gt;s&lt;/mi&gt;&lt;mi&gt;o&lt;/mi&gt;&lt;mi&gt;f&lt;/mi&gt;&lt;mi&gt;t&lt;/mi&gt;&lt;mi&gt;m&lt;/mi&gt;&lt;mi&gt;a&lt;/mi&gt;&lt;mi&gt;x&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;msup&gt;&lt;mi mathvariant=&quot;bold&quot;&gt;o&lt;/mi&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo mathvariant=&quot;bold&quot; stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;mi mathvariant=&quot;bold&quot;&gt;t&lt;/mi&gt;&lt;mo mathvariant=&quot;bold&quot; stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/mrow&gt;&lt;/msup&gt;&lt;/mrow&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-176" style="width: 10.94em; display: inline-block;"><span style="display: inline-block; position: relative; width: 9.117em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.044em, 1009.01em, 2.607em, -999.997em); top: -2.185em; left: 0em;"><span class="mrow" id="MathJax-Span-177"><span class="texatom" id="MathJax-Span-178"><span class="mrow" id="MathJax-Span-179"><span class="msubsup" id="MathJax-Span-180"><span style="display: inline-block; position: relative; width: 1.617em; height: 0px;"><span style="position: absolute; clip: rect(3.128em, 1000.58em, 4.378em, -999.997em); top: -4.008em; left: 0em;"><span class="texatom" id="MathJax-Span-181"><span class="mrow" id="MathJax-Span-182"><span class="munderover" id="MathJax-Span-183"><span style="display: inline-block; position: relative; width: 0.628em; height: 0px;"><span style="position: absolute; clip: rect(3.388em, 1000.58em, 4.378em, -999.997em); top: -4.008em; left: 0em;"><span class="mi" id="MathJax-Span-184" style="font-family: MathJax_Main-bold;">y</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; clip: rect(3.18em, 1000.47em, 3.648em, -999.997em); top: -4.06em; left: 0.003em;"><span class="mo" id="MathJax-Span-185" style="font-family: MathJax_Main-bold;">^</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; top: -4.477em; left: 0.628em;"><span class="texatom" id="MathJax-Span-186"><span class="mrow" id="MathJax-Span-187"><span class="mo" id="MathJax-Span-188" style="font-size: 70.7%; font-family: MathJax_Main-bold;">(</span><span class="mi" id="MathJax-Span-189" style="font-size: 70.7%; font-family: MathJax_Main-bold;">t</span><span class="mo" id="MathJax-Span-190" style="font-size: 70.7%; font-family: MathJax_Main-bold;">)</span></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span></span></span></span><span class="mo" id="MathJax-Span-191" style="font-family: MathJax_Main; padding-left: 0.263em;">=</span><span class="mi" id="MathJax-Span-192" style="font-family: MathJax_Math-italic; padding-left: 0.263em;">s</span><span class="mi" id="MathJax-Span-193" style="font-family: MathJax_Math-italic;">o</span><span class="mi" id="MathJax-Span-194" style="font-family: MathJax_Math-italic;">f<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.055em;"></span></span><span class="mi" id="MathJax-Span-195" style="font-family: MathJax_Math-italic;">t</span><span class="mi" id="MathJax-Span-196" style="font-family: MathJax_Math-italic;">m</span><span class="mi" id="MathJax-Span-197" style="font-family: MathJax_Math-italic;">a</span><span class="mi" id="MathJax-Span-198" style="font-family: MathJax_Math-italic;">x</span><span class="mo" id="MathJax-Span-199" style="font-family: MathJax_Main;">(</span><span class="texatom" id="MathJax-Span-200"><span class="mrow" id="MathJax-Span-201"><span class="msubsup" id="MathJax-Span-202"><span style="display: inline-block; position: relative; width: 1.617em; height: 0px;"><span style="position: absolute; clip: rect(3.388em, 1000.52em, 4.169em, -999.997em); top: -4.008em; left: 0em;"><span class="mi" id="MathJax-Span-203" style="font-family: MathJax_Main-bold;">o</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; top: -4.372em; left: 0.576em;"><span class="texatom" id="MathJax-Span-204"><span class="mrow" id="MathJax-Span-205"><span class="mo" id="MathJax-Span-206" style="font-size: 70.7%; font-family: MathJax_Main-bold;">(</span><span class="mi" id="MathJax-Span-207" style="font-size: 70.7%; font-family: MathJax_Main-bold;">t</span><span class="mo" id="MathJax-Span-208" style="font-size: 70.7%; font-family: MathJax_Main-bold;">)</span></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span></span></span></span><span class="mo" id="MathJax-Span-209" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.19em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.372em; border-left: 0px solid; width: 0px; height: 1.628em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mrow class="MJX-TeXAtom-ORD"><msup><mrow class="MJX-TeXAtom-ORD"><mover><mi mathvariant="bold">y</mi><mo mathvariant="bold" stretchy="false">^</mo></mover></mrow><mrow class="MJX-TeXAtom-ORD"><mo mathvariant="bold" stretchy="false">(</mo><mi mathvariant="bold">t</mi><mo mathvariant="bold" stretchy="false">)</mo></mrow></msup></mrow><mo>=</mo><mi>s</mi><mi>o</mi><mi>f</mi><mi>t</mi><mi>m</mi><mi>a</mi><mi>x</mi><mo stretchy="false">(</mo><mrow class="MJX-TeXAtom-ORD"><msup><mi mathvariant="bold">o</mi><mrow class="MJX-TeXAtom-ORD"><mo mathvariant="bold" stretchy="false">(</mo><mi mathvariant="bold">t</mi><mo mathvariant="bold" stretchy="false">)</mo></mrow></msup></mrow><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-11">\mathbf{\hat{y}^{(t)}} = softmax(\mathbf{o^{(t)}})</script></p>

<p>Inicijalizacija početnog skrivenog stanja <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-12-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msup&gt;&lt;mi&gt;h&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;/msup&gt;&lt;mn&gt;0&lt;/mn&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-210" style="width: 2.19em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.826em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.148em, 1001.72em, 2.607em, -999.997em); top: -2.185em; left: 0em;"><span class="mrow" id="MathJax-Span-211"><span class="msubsup" id="MathJax-Span-212"><span style="display: inline-block; position: relative; width: 0.94em; height: 0px;"><span style="position: absolute; clip: rect(3.18em, 1000.58em, 4.169em, -999.997em); top: -4.008em; left: 0em;"><span class="mi" id="MathJax-Span-213" style="font-family: MathJax_Math-italic;">h</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; top: -4.372em; left: 0.576em;"><span class="mo" id="MathJax-Span-214" style="font-size: 70.7%; font-family: MathJax_Main;">(</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span></span><span class="mn" id="MathJax-Span-215" style="font-family: MathJax_Main;">0</span><span class="mo" id="MathJax-Span-216" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.19em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.372em; border-left: 0px solid; width: 0px; height: 1.503em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msup><mi>h</mi><mo stretchy="false">(</mo></msup><mn>0</mn><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-12">h^(0)</script> se u jednostavnim primjenama ostavlja nasumičnosti ili inicijalizira na nule - no u praksi je bolje tretirati početno stanje kao parametar algoritma koji učimo. Unutar okvira laboratorijske vježbe dovoljno je inicijalizirati ga na vektor nula.</p>

<p>Parametri ove mreže su, prema tome matrice  <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-13-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;U&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-217" style="width: 0.94em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.784em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.305em, 1000.78em, 2.294em, -999.997em); top: -2.133em; left: 0em;"><span class="mrow" id="MathJax-Span-218"><span class="mi" id="MathJax-Span-219" style="font-family: MathJax_Math-italic;">U<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.107em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.138em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 1.003em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>U</mi></math></span></span><script type="math/tex" id="MathJax-Element-13">U</script> <em>(ulaz)</em>, <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-14-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;V&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-220" style="width: 0.94em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.784em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.305em, 1000.78em, 2.294em, -999.997em); top: -2.133em; left: 0em;"><span class="mrow" id="MathJax-Span-221"><span class="mi" id="MathJax-Span-222" style="font-family: MathJax_Math-italic;">V<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.211em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.138em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 1.003em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>V</mi></math></span></span><script type="math/tex" id="MathJax-Element-14">V</script> <em>(van)</em> i <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-15-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;W&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-223" style="width: 1.253em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.044em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.305em, 1001.04em, 2.294em, -999.997em); top: -2.133em; left: 0em;"><span class="mrow" id="MathJax-Span-224"><span class="mi" id="MathJax-Span-225" style="font-family: MathJax_Math-italic;">W<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.107em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.138em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 1.003em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>W</mi></math></span></span><script type="math/tex" id="MathJax-Element-15">W</script> (<em>skriVeni-skriVeni</em>) te vektori pristranosti <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-16-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;b&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-226" style="width: 0.523em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.419em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.305em, 1000.42em, 2.294em, -999.997em); top: -2.133em; left: 0em;"><span class="mrow" id="MathJax-Span-227"><span class="mi" id="MathJax-Span-228" style="font-family: MathJax_Math-italic;">b</span></span><span style="display: inline-block; width: 0px; height: 2.138em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 1.003em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>b</mi></math></span></span><script type="math/tex" id="MathJax-Element-16">b</script> i <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-17-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mi&gt;c&lt;/mi&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-229" style="width: 0.523em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.419em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.565em, 1000.42em, 2.294em, -999.997em); top: -2.133em; left: 0em;"><span class="mrow" id="MathJax-Span-230"><span class="mi" id="MathJax-Span-231" style="font-family: MathJax_Math-italic;">c</span></span><span style="display: inline-block; width: 0px; height: 2.138em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 0.691em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>c</mi></math></span></span><script type="math/tex" id="MathJax-Element-17">c</script>.</p>

<p>Pri modeliranju jezika kao izlaz mreže u svakom vremenskom koraku ćemo imati klasifikacijski problem (koje je iduće slovo?), te ćemo koristiti gubitak unakrsne entropije s kojim ste se upoznali u prethodnoj laboratorijskoj vježbi.</p>

<p>Za podsjetnik, u nastavku su jednadžba unakrsne entropije te njenog gradijenta, prilagođene notacijom za jednadžbe povratnih neuronskih mreža.</p>

<span class="MathJax_Preview" style="color: inherit; display: none;"></span><div class="MathJax_Display"><span class="MathJax MathJax_FullWidth" id="MathJax-Element-18-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;&gt;&lt;mi&gt;L&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;munderover&gt;&lt;mo&gt;&amp;#x2211;&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mn&gt;1&lt;/mn&gt;&lt;/mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi&gt;C&lt;/mi&gt;&lt;/mrow&gt;&lt;/munderover&gt;&lt;msub&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;bold&quot;&gt;y&lt;/mi&gt;&lt;/mrow&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;mi&gt;l&lt;/mi&gt;&lt;mi&gt;o&lt;/mi&gt;&lt;mi&gt;g&lt;/mi&gt;&lt;mo stretchy=&quot;false&quot;&gt;(&lt;/mo&gt;&lt;msub&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mover&gt;&lt;mi mathvariant=&quot;bold&quot;&gt;y&lt;/mi&gt;&lt;mo mathvariant=&quot;bold&quot; stretchy=&quot;false&quot;&gt;&amp;#x005E;&lt;/mo&gt;&lt;/mover&gt;&lt;/mrow&gt;&lt;/mrow&gt;&lt;mi&gt;i&lt;/mi&gt;&lt;/msub&gt;&lt;mo stretchy=&quot;false&quot;&gt;)&lt;/mo&gt;&lt;mspace linebreak=&quot;newline&quot; /&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-232" style="width: 100%; display: inline-block; min-width: 10.159em;"><span style="display: inline-block; position: relative; width: 100%; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(2.451em, 1008.34em, 6.148em, -999.997em); top: -4.372em; left: 0em; width: 100%;"><span class="mrow" id="MathJax-Span-233"><span style="display: inline-block; position: relative; width: 100%; height: 0px;"><span style="position: absolute; clip: rect(2.086em, 1008.34em, 5.367em, -999.997em); top: -4.008em; left: 50%; margin-left: -4.216em;"><span class="mi" id="MathJax-Span-234" style="font-family: MathJax_Math-italic;">L</span><span class="mo" id="MathJax-Span-235" style="font-family: MathJax_Main; padding-left: 0.263em;">=</span><span class="mo" id="MathJax-Span-236" style="font-family: MathJax_Main; padding-left: 0.263em;">−</span><span class="munderover" id="MathJax-Span-237" style="padding-left: 0.159em;"><span style="display: inline-block; position: relative; width: 1.461em; height: 0px;"><span style="position: absolute; clip: rect(2.919em, 1001.41em, 4.638em, -999.997em); top: -4.008em; left: 0em;"><span class="mo" id="MathJax-Span-238" style="font-family: MathJax_Size2; vertical-align: 0em;">∑</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; clip: rect(3.388em, 1001.1em, 4.273em, -999.997em); top: -2.914em; left: 0.159em;"><span class="texatom" id="MathJax-Span-239"><span class="mrow" id="MathJax-Span-240"><span class="mi" id="MathJax-Span-241" style="font-size: 70.7%; font-family: MathJax_Math-italic;">i</span><span class="mo" id="MathJax-Span-242" style="font-size: 70.7%; font-family: MathJax_Main;">=</span><span class="mn" id="MathJax-Span-243" style="font-size: 70.7%; font-family: MathJax_Main;">1</span></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; clip: rect(3.284em, 1000.52em, 4.169em, -999.997em); top: -5.154em; left: 0.471em;"><span class="texatom" id="MathJax-Span-244"><span class="mrow" id="MathJax-Span-245"><span class="mi" id="MathJax-Span-246" style="font-size: 70.7%; font-family: MathJax_Math-italic;">C<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.055em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span></span><span class="msubsup" id="MathJax-Span-247" style="padding-left: 0.159em;"><span style="display: inline-block; position: relative; width: 0.94em; height: 0px;"><span style="position: absolute; clip: rect(3.388em, 1000.58em, 4.378em, -999.997em); top: -4.008em; left: 0em;"><span class="texatom" id="MathJax-Span-248"><span class="mrow" id="MathJax-Span-249"><span class="mi" id="MathJax-Span-250" style="font-family: MathJax_Main-bold;">y</span></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; top: -3.747em; left: 0.628em;"><span class="mi" id="MathJax-Span-251" style="font-size: 70.7%; font-family: MathJax_Math-italic;">i</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span></span><span class="mi" id="MathJax-Span-252" style="font-family: MathJax_Math-italic;">l</span><span class="mi" id="MathJax-Span-253" style="font-family: MathJax_Math-italic;">o</span><span class="mi" id="MathJax-Span-254" style="font-family: MathJax_Math-italic;">g<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mo" id="MathJax-Span-255" style="font-family: MathJax_Main;">(</span><span class="msubsup" id="MathJax-Span-256"><span style="display: inline-block; position: relative; width: 0.94em; height: 0px;"><span style="position: absolute; clip: rect(3.128em, 1000.58em, 4.378em, -999.997em); top: -4.008em; left: 0em;"><span class="texatom" id="MathJax-Span-257"><span class="mrow" id="MathJax-Span-258"><span class="texatom" id="MathJax-Span-259"><span class="mrow" id="MathJax-Span-260"><span class="munderover" id="MathJax-Span-261"><span style="display: inline-block; position: relative; width: 0.628em; height: 0px;"><span style="position: absolute; clip: rect(3.388em, 1000.58em, 4.378em, -999.997em); top: -4.008em; left: 0em;"><span class="mi" id="MathJax-Span-262" style="font-family: MathJax_Main-bold;">y</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; clip: rect(3.18em, 1000.47em, 3.648em, -999.997em); top: -4.06em; left: 0.003em;"><span class="mo" id="MathJax-Span-263" style="font-family: MathJax_Main-bold;">^</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; top: -3.747em; left: 0.628em;"><span class="mi" id="MathJax-Span-264" style="font-size: 70.7%; font-family: MathJax_Math-italic;">i</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span></span><span class="mo" id="MathJax-Span-265" style="font-family: MathJax_Main;">)</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; clip: rect(3.857em, 1000em, 4.169em, -999.997em); top: -2.393em; left: 50%; margin-left: 0em;"><span class="mspace" id="MathJax-Span-266" style="height: 0em; vertical-align: 0em; width: 0em; display: inline-block; overflow: hidden;"></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.378em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -1.997em; border-left: 0px solid; width: 0px; height: 4.191em;"></span></span></nobr><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mi>L</mi><mo>=</mo><mo>−</mo><munderover><mo>∑</mo><mrow class="MJX-TeXAtom-ORD"><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mrow class="MJX-TeXAtom-ORD"><mi>C</mi></mrow></munderover><msub><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="bold">y</mi></mrow><mi>i</mi></msub><mi>l</mi><mi>o</mi><mi>g</mi><mo stretchy="false">(</mo><msub><mrow class="MJX-TeXAtom-ORD"><mrow class="MJX-TeXAtom-ORD"><mover><mi mathvariant="bold">y</mi><mo mathvariant="bold" stretchy="false">^</mo></mover></mrow></mrow><mi>i</mi></msub><mo stretchy="false">)</mo><mspace linebreak="newline"></mspace></math></span></span></div><script type="math/tex; mode=display" id="MathJax-Element-18">L = - \sum_{i=1}^{C} \mathbf{y}_i log(\mathbf{\hat{y}}_i) \\</script>

<span class="MathJax_Preview" style="color: inherit; display: none;"></span><div class="MathJax_Display"><span class="MathJax MathJax_FullWidth" id="MathJax-Element-19-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot; display=&quot;block&quot;&gt;&lt;mfrac&gt;&lt;mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo&gt;&amp;#x2202;&lt;/mo&gt;&lt;/mrow&gt;&lt;mi&gt;L&lt;/mi&gt;&lt;/mrow&gt;&lt;mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mo&gt;&amp;#x2202;&lt;/mo&gt;&lt;/mrow&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;bold&quot;&gt;o&lt;/mi&gt;&lt;/mrow&gt;&lt;/mrow&gt;&lt;/mfrac&gt;&lt;mo&gt;=&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mover&gt;&lt;mi mathvariant=&quot;bold&quot;&gt;y&lt;/mi&gt;&lt;mo mathvariant=&quot;bold&quot; stretchy=&quot;false&quot;&gt;&amp;#x005E;&lt;/mo&gt;&lt;/mover&gt;&lt;/mrow&gt;&lt;/mrow&gt;&lt;mo&gt;&amp;#x2212;&lt;/mo&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;bold&quot;&gt;y&lt;/mi&gt;&lt;/mrow&gt;&lt;mspace linebreak=&quot;newline&quot; /&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-267" style="width: 100%; display: inline-block; min-width: 6.409em;"><span style="display: inline-block; position: relative; width: 100%; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(2.451em, 1005.26em, 5.367em, -999.997em); top: -4.008em; left: 0em; width: 100%;"><span class="mrow" id="MathJax-Span-268"><span style="display: inline-block; position: relative; width: 100%; height: 0px;"><span style="position: absolute; clip: rect(2.451em, 1005.26em, 4.898em, -999.997em); top: -4.008em; left: 50%; margin-left: -2.654em;"><span class="mfrac" id="MathJax-Span-269"><span style="display: inline-block; position: relative; width: 1.357em; height: 0px; margin-right: 0.107em; margin-left: 0.107em;"><span style="position: absolute; clip: rect(3.128em, 1001.2em, 4.169em, -999.997em); top: -4.685em; left: 50%; margin-left: -0.622em;"><span class="mrow" id="MathJax-Span-270"><span class="texatom" id="MathJax-Span-271"><span class="mrow" id="MathJax-Span-272"><span class="mo" id="MathJax-Span-273" style="font-family: MathJax_Main;">∂</span></span></span><span class="mi" id="MathJax-Span-274" style="font-family: MathJax_Math-italic;">L</span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; clip: rect(3.128em, 1001.1em, 4.169em, -999.997em); top: -3.331em; left: 50%; margin-left: -0.57em;"><span class="mrow" id="MathJax-Span-275"><span class="texatom" id="MathJax-Span-276"><span class="mrow" id="MathJax-Span-277"><span class="mo" id="MathJax-Span-278" style="font-family: MathJax_Main;">∂</span></span></span><span class="texatom" id="MathJax-Span-279"><span class="mrow" id="MathJax-Span-280"><span class="mi" id="MathJax-Span-281" style="font-family: MathJax_Main-bold;">o</span></span></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; clip: rect(0.836em, 1001.36em, 1.201em, -999.997em); top: -1.247em; left: 0em;"><span style="display: inline-block; overflow: hidden; vertical-align: 0em; border-top: 1.3px solid; width: 1.357em; height: 0px;"></span><span style="display: inline-block; width: 0px; height: 1.044em;"></span></span></span></span><span class="mo" id="MathJax-Span-282" style="font-family: MathJax_Main; padding-left: 0.263em;">=</span><span class="texatom" id="MathJax-Span-283" style="padding-left: 0.263em;"><span class="mrow" id="MathJax-Span-284"><span class="texatom" id="MathJax-Span-285"><span class="mrow" id="MathJax-Span-286"><span class="munderover" id="MathJax-Span-287"><span style="display: inline-block; position: relative; width: 0.628em; height: 0px;"><span style="position: absolute; clip: rect(3.388em, 1000.58em, 4.378em, -999.997em); top: -4.008em; left: 0em;"><span class="mi" id="MathJax-Span-288" style="font-family: MathJax_Main-bold;">y</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; clip: rect(3.18em, 1000.47em, 3.648em, -999.997em); top: -4.06em; left: 0.003em;"><span class="mo" id="MathJax-Span-289" style="font-family: MathJax_Main-bold;">^</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span></span></span></span></span></span><span class="mo" id="MathJax-Span-290" style="font-family: MathJax_Main; padding-left: 0.211em;">−</span><span class="texatom" id="MathJax-Span-291" style="padding-left: 0.211em;"><span class="mrow" id="MathJax-Span-292"><span class="mi" id="MathJax-Span-293" style="font-family: MathJax_Main-bold;">y</span></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; clip: rect(3.857em, 1000em, 4.169em, -999.997em); top: -2.81em; left: 50%; margin-left: 0em;"><span class="mspace" id="MathJax-Span-294" style="height: 0em; vertical-align: 0em; width: 0em; display: inline-block; overflow: hidden;"></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span></span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -1.497em; border-left: 0px solid; width: 0px; height: 3.253em;"></span></span></nobr><span class="MJX_Assistive_MathML MJX_Assistive_MathML_Block" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mfrac><mrow><mrow class="MJX-TeXAtom-ORD"><mo>∂</mo></mrow><mi>L</mi></mrow><mrow><mrow class="MJX-TeXAtom-ORD"><mo>∂</mo></mrow><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="bold">o</mi></mrow></mrow></mfrac><mo>=</mo><mrow class="MJX-TeXAtom-ORD"><mrow class="MJX-TeXAtom-ORD"><mover><mi mathvariant="bold">y</mi><mo mathvariant="bold" stretchy="false">^</mo></mover></mrow></mrow><mo>−</mo><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="bold">y</mi></mrow><mspace linebreak="newline"></mspace></math></span></span></div><script type="math/tex; mode=display" id="MathJax-Element-19">\frac{∂L}{∂\mathbf{o}} = \mathbf{\hat{y}} - \mathbf{y} \\</script>

<p>Pri čemu je <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-20-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mover&gt;&lt;mi mathvariant=&quot;bold&quot;&gt;y&lt;/mi&gt;&lt;mo mathvariant=&quot;bold&quot; stretchy=&quot;false&quot;&gt;&amp;#x005E;&lt;/mo&gt;&lt;/mover&gt;&lt;/mrow&gt;&lt;/mrow&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-295" style="width: 0.784em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.628em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.253em, 1000.58em, 2.503em, -999.997em); top: -2.133em; left: 0em;"><span class="mrow" id="MathJax-Span-296"><span class="texatom" id="MathJax-Span-297"><span class="mrow" id="MathJax-Span-298"><span class="texatom" id="MathJax-Span-299"><span class="mrow" id="MathJax-Span-300"><span class="munderover" id="MathJax-Span-301"><span style="display: inline-block; position: relative; width: 0.628em; height: 0px;"><span style="position: absolute; clip: rect(3.388em, 1000.58em, 4.378em, -999.997em); top: -4.008em; left: 0em;"><span class="mi" id="MathJax-Span-302" style="font-family: MathJax_Main-bold;">y</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; clip: rect(3.18em, 1000.47em, 3.648em, -999.997em); top: -4.06em; left: 0.003em;"><span class="mo" id="MathJax-Span-303" style="font-family: MathJax_Main-bold;">^</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span></span></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.138em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 1.253em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mrow class="MJX-TeXAtom-ORD"><mrow class="MJX-TeXAtom-ORD"><mover><mi mathvariant="bold">y</mi><mo mathvariant="bold" stretchy="false">^</mo></mover></mrow></mrow></math></span></span><script type="math/tex" id="MathJax-Element-20">\mathbf{\hat{y}}</script> vektor vjerojatnosti dobiven kao izlaz mreže, dok je <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-21-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;mrow class=&quot;MJX-TeXAtom-ORD&quot;&gt;&lt;mi mathvariant=&quot;bold&quot;&gt;y&lt;/mi&gt;&lt;/mrow&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-304" style="width: 0.784em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.628em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.565em, 1000.58em, 2.555em, -999.997em); top: -2.185em; left: 0em;"><span class="mrow" id="MathJax-Span-305"><span class="texatom" id="MathJax-Span-306"><span class="mrow" id="MathJax-Span-307"><span class="mi" id="MathJax-Span-308" style="font-family: MathJax_Main-bold;">y</span></span></span></span><span style="display: inline-block; width: 0px; height: 2.19em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.309em; border-left: 0px solid; width: 0px; height: 0.878em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mrow class="MJX-TeXAtom-ORD"><mi mathvariant="bold">y</mi></mrow></math></span></span><script type="math/tex" id="MathJax-Element-21">\mathbf{y}</script> stvarna distribucija razreda (naješće, one-hot vektor s jedinicom na lokaciji točnog razreda).</p>

<h4 id="21-implementacija-povratne-neuronske-mreže">2.1: Implementacija povratne neuronske mreže</h4>

<p>Obična povratna neuronska mreža ima tri različita hiperparametra - veličinu skrivenog sloja, duljinu vremenskog odmatanja te stopu učenja, te prethodno navedene matrice i vektore parametara. Algoritam učenja koji trebate implementirati je Adagrad.</p>

<p>Uz pretpostavku standardne precizosti decimalnih brojeva (single precision, 4 bytes), veličine skrivenog sloja 500, zadatka modeliranja jezika s vokabularom veličine 70 (dimenzija ulaza te izlaza) - koliko je ukupno memorijsko zauzeće bez overheada programskog jezika? Koji parametar zauzima najviše prostora? Ponovite istu računicu za vokabular veličine 10000.</p>

<p>Navedene veličine vokabulara su slične onima koje ćete imati za modele na razini znakova (70 - u praksi bliže 150), te za modele na razini riječi (red veličine <span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-22-Frame" tabindex="0" data-mathml="&lt;math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;&gt;&lt;msup&gt;&lt;mn&gt;10&lt;/mn&gt;&lt;mn&gt;5&lt;/mn&gt;&lt;/msup&gt;&lt;/math&gt;" role="presentation" style="position: relative;"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-309" style="width: 1.721em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.409em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.096em, 1001.41em, 2.294em, -999.997em); top: -2.133em; left: 0em;"><span class="mrow" id="MathJax-Span-310"><span class="msubsup" id="MathJax-Span-311"><span style="display: inline-block; position: relative; width: 1.409em; height: 0px;"><span style="position: absolute; clip: rect(3.18em, 1000.94em, 4.169em, -999.997em); top: -4.008em; left: 0em;"><span class="mn" id="MathJax-Span-312" style="font-family: MathJax_Main;">10</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span><span style="position: absolute; top: -4.424em; left: 0.992em;"><span class="mn" id="MathJax-Span-313" style="font-size: 70.7%; font-family: MathJax_Main;">5</span><span style="display: inline-block; width: 0px; height: 4.013em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.138em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.059em; border-left: 0px solid; width: 0px; height: 1.191em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msup><mn>10</mn><mn>5</mn></msup></math></span></span><script type="math/tex" id="MathJax-Element-22">10^5</script>).</p>

<p>Predloženi početni hiperparametri vaše implementacije su veličina skrivenog sloja 100, duljina vremenskog odmatanja 30 te stopa učenja 1e-1.</p>

<p>Implementaciju povratne neuronske mreže možemo podijeliti u 4 konceptualna dijela kao u nastavku:</p>

<h5 id="211-inicijalizacija-parametara">2.1.1: Inicijalizacija parametara</h5>

<p>Hiperparametre inicijalizirajte po preporučenim vrijednostima radi reproducibilnosti, dok matrice parametara inicijalizirajte nasumično iz gaussove distribucije s standardnom devijacijom 1e-2. Vektore pristranosti inicijalizirajte na nule.</p>

<p>Primjer inicijalizacije parametara bi mogao izgledati kao u nastavku:</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># ...</span>
<span class="c"># Code is nested in class definition, indentation is not representative.</span>
<span class="c"># "np" stands for numpy</span>
<span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">hidden_size</span><span class="p">,</span> <span class="n">sequence_length</span><span class="p">,</span> <span class="n">vocab_size</span><span class="p">,</span> <span class="n">learning_rate</span><span class="p">):</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">hidden_size</span> <span class="o">=</span> <span class="n">hidden_size</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">sequence_length</span> <span class="o">=</span> <span class="n">sequence_length</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">vocab_size</span> <span class="o">=</span> <span class="n">vocab_size</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">learning_rate</span> <span class="o">=</span> <span class="n">learning_rate</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">U</span> <span class="o">=</span> <span class="bp">None</span> <span class="c"># ... input projection</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">W</span> <span class="o">=</span> <span class="bp">None</span> <span class="c"># ... hidden-to-hidden projection</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">b</span> <span class="o">=</span> <span class="bp">None</span> <span class="c"># ... input bias</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">V</span> <span class="o">=</span> <span class="bp">None</span> <span class="c"># ... output projection</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">c</span> <span class="o">=</span> <span class="bp">None</span> <span class="c"># ... output bias</span>

    <span class="c"># memory of past gradients - rolling sum of squares for Adagrad</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">memory_U</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">memory_W</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">memory_V</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros_like</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">U</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros_like</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">W</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros_like</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">V</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">memory_b</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">memory_c</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros_like</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">b</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros_like</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">c</span><span class="p">)</span>

</code></pre></div></div>

<p>Pri inicijalizaciji vektora pristranosti podsjetite se dodati redundantnu dimenziju kako bi numpy prepoznao dimenziju broadcastinga. Zbrajanje dimenzija (HxD + H) neće nužno producirati željene rezultate, te je lakše inicijalizirati vektore pristranosti na Hx1.</p>

<h5 id="212-prolaz-unaprijed">2.1.2: Prolaz unaprijed</h5>

<p>Prolaz unaprijed povratne neuronske mreže možete zamisliti kao petlju u kojoj iterativno obrađujemo vremenske korake. Prolaz unaprijed prema tome možemo konceptualno razdvojiti u funkciju koja obrađuje jedan jedini korak unaprijed kroz vrijeme, te funkciju koja obrađuje cijeli vremenski slijed te iterativno zove prethodnu.</p>

<p>Kosturi tih funkcija bi mogli izgledati kao u nastavku (kao u većini paketa za duboko učenje):</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># ...</span>
<span class="c"># Code is nested in class definition, indentation is not representative.</span>

<span class="k">def</span> <span class="nf">rnn_step_forward</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">h_prev</span><span class="p">,</span> <span class="n">U</span><span class="p">,</span> <span class="n">W</span><span class="p">,</span> <span class="n">b</span><span class="p">):</span>
    <span class="c"># A single time step forward of a recurrent neural network with a </span>
    <span class="c"># hyperbolic tangent nonlinearity.</span>

    <span class="c"># x - input data (minibatch size x input dimension)</span>
    <span class="c"># h_prev - previous hidden state (minibatch size x hidden size)</span>
    <span class="c"># U - input projection matrix (input dimension x hidden size)</span>
    <span class="c"># W - hidden to hidden projection matrix (hidden size x hidden size)</span>
    <span class="c"># b - bias of shape (hidden size x 1)</span>

    <span class="n">h_current</span><span class="p">,</span> <span class="n">cache</span> <span class="o">=</span> <span class="bp">None</span><span class="p">,</span> <span class="bp">None</span>
    
    <span class="c"># return the new hidden state and a tuple of values needed for the backward step</span>

    <span class="k">return</span> <span class="n">h_current</span><span class="p">,</span> <span class="n">cache</span>


<span class="k">def</span> <span class="nf">rnn_forward</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">h0</span><span class="p">,</span> <span class="n">U</span><span class="p">,</span> <span class="n">W</span><span class="p">,</span> <span class="n">b</span><span class="p">):</span>
    <span class="c"># Full unroll forward of the recurrent neural network with a </span>
    <span class="c"># hyperbolic tangent nonlinearity</span>

    <span class="c"># x - input data for the whole time-series (minibatch size x sequence_length x input dimension)</span>
    <span class="c"># h0 - initial hidden state (minibatch size x hidden size)</span>
    <span class="c"># U - input projection matrix (input dimension x hidden size)</span>
    <span class="c"># W - hidden to hidden projection matrix (hidden size x hidden size)</span>
    <span class="c"># b - bias of shape (hidden size x 1)</span>
    
    <span class="n">h</span><span class="p">,</span> <span class="n">cache</span> <span class="o">=</span> <span class="bp">None</span><span class="p">,</span> <span class="bp">None</span>

    <span class="c"># return the hidden states for the whole time series (T+1) and a tuple of values needed for the backward step</span>

    <span class="k">return</span> <span class="n">h</span><span class="p">,</span> <span class="n">cache</span>

</code></pre></div></div>

<p>Primjetite da iako parametri U, W i b postoje u razredu (self.U, self.W, self.b), zbog reproducibilnosti te numeričke provjere operacija preporuča se, no nije nužno, držati ih kao parametre funkcija. U slučaju da se koriste vrijednosti iz razreda (ili drukčija implementacija povratne neuronske mreže), provjera implementacije je na studentu. U suprotnom, ispravno je primjetiti da ove funkcije mogu biti statičke (<code class="highlighter-rouge">@staticmethod</code> dekorator).</p>

<h5 id="213-prolaz-unatrag">2.1.3: Prolaz unatrag</h5>

<p>Prolaz unatrag neuronske mreže je konceptualno sličan prolazu unaprijed, uz izmjenu da se iteracija vrši od zadnjeg vremenskog koraka prema prvom. Prolaz unatrag se vrši algoritom propagacije unatrag kroz vrijeme <em>(engl. backpropagation through time, BPTT)</em>. Kosturi funkcija za propagaciju unatrag mogu izgledati kao u nastavku:</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># ...</span>
<span class="c"># Code is nested in class definition, indentation is not representative.</span>

<span class="k">def</span> <span class="nf">rnn_step_backward</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">grad_next</span><span class="p">,</span> <span class="n">cache</span><span class="p">):</span>
    <span class="c"># A single time step backward of a recurrent neural network with a </span>
    <span class="c"># hyperbolic tangent nonlinearity.</span>

    <span class="c"># grad_next - upstream gradient of the loss with respect to the next hidden state and current output</span>
    <span class="c"># cache - cached information from the forward pass</span>

    <span class="n">dh_prev</span><span class="p">,</span> <span class="n">dU</span><span class="p">,</span> <span class="n">dW</span><span class="p">,</span> <span class="n">db</span> <span class="o">=</span> <span class="bp">None</span><span class="p">,</span> <span class="bp">None</span><span class="p">,</span> <span class="bp">None</span><span class="p">,</span> <span class="bp">None</span>
    
    <span class="c"># compute and return gradients with respect to each parameter</span>
    <span class="c"># HINT: you can use the chain rule to compute the derivative of the</span>
    <span class="c"># hyperbolic tangent function and use it to compute the gradient</span>
    <span class="c"># with respect to the remaining parameters</span>

    <span class="k">return</span> <span class="n">dh_prev</span><span class="p">,</span> <span class="n">dU</span><span class="p">,</span> <span class="n">dW</span><span class="p">,</span> <span class="n">db</span>


<span class="k">def</span> <span class="nf">rnn_backward</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">dh</span><span class="p">,</span> <span class="n">cache</span><span class="p">):</span>
    <span class="c"># Full unroll forward of the recurrent neural network with a </span>
    <span class="c"># hyperbolic tangent nonlinearity</span>
    
    <span class="n">dU</span><span class="p">,</span> <span class="n">dW</span><span class="p">,</span> <span class="n">db</span> <span class="o">=</span> <span class="bp">None</span><span class="p">,</span> <span class="bp">None</span><span class="p">,</span> <span class="bp">None</span>

    <span class="c"># compute and return gradients with respect to each parameter</span>
    <span class="c"># for the whole time series.</span>
    <span class="c"># Why are we not computing the gradient with respect to inputs (x)?</span>

    <span class="k">return</span> <span class="n">dU</span><span class="p">,</span> <span class="n">dW</span><span class="p">,</span> <span class="n">db</span>

</code></pre></div></div>

<p>Kako biste spriječili problem eksplodirajućih gradijenata, prije nego što primjenite ukupni gradijent kroz sve korake na parametre, koristite podrezivanje vrijednosti gradijenata po komponentama (gradient clipping). Preporuča se koristiti metoda <code class="highlighter-rouge">np.clip()</code>, te vrijednosti ostavljati u intervalu od -5 do 5.</p>

<h5 id="214-petlja-učenja">2.1.4: Petlja učenja</h5>

<p>Unutar petlje učenja potrebno je povezati povratnu neuronsku mrežu s ulaznim podacima, izračunati gubitak na izlazu mreže te vršiti postupak optimizacije parametara. Idejno, neuronska mreža bi trebala biti neovisna o podacima - tako da je sasvim u redu odvojiti kontrolu iteriranja po epohama i minibatchevima izvan razreda mreže, dok će mreža obrađivati pojedine korake optimizacije.</p>

<p>Implementacija kostura funkcije za izračun gubitka bi mogla izgledati ovako:</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># ...</span>
<span class="c"># Code is nested in class definition, indentation is not representative.</span>

<span class="k">def</span> <span class="nf">output</span><span class="p">(</span><span class="n">h</span><span class="p">,</span> <span class="n">V</span><span class="p">,</span> <span class="n">c</span><span class="p">):</span>
    <span class="c"># Calculate the output probabilities of the network</span>

<span class="k">def</span> <span class="nf">output_loss_and_grads</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">h</span><span class="p">,</span> <span class="n">V</span><span class="p">,</span> <span class="n">c</span><span class="p">,</span> <span class="n">y</span><span class="p">):</span>
    <span class="c"># Calculate the loss of the network for each of the outputs</span>
    
    <span class="c"># h - hidden states of the network for each timestep. </span>
    <span class="c">#     the dimensionality of h is (batch size x sequence length x hidden size (the initial state is irrelevant for the output)</span>
    <span class="c"># V - the output projection matrix of dimension hidden size x vocabulary size</span>
    <span class="c"># c - the output bias of dimension vocabulary size x 1</span>
    <span class="c"># y - the true class distribution - a tensor of dimension </span>
    <span class="c">#     batch_size x sequence_length x vocabulary size - you need to do this conversion prior to</span>
    <span class="c">#     passing the argument. A fast way to create a one-hot vector from</span>
    <span class="c">#     an id could be something like the following code:</span>

    <span class="c">#   y[batch_id][timestep] = np.zeros((vocabulary_size, 1))</span>
    <span class="c">#   y[batch_id][timestep][batch_y[timestep]] = 1</span>

    <span class="c">#     where y might be a list or a dictionary.</span>

    <span class="n">loss</span><span class="p">,</span> <span class="n">dh</span><span class="p">,</span> <span class="n">dV</span><span class="p">,</span> <span class="n">dc</span> <span class="o">=</span> <span class="bp">None</span><span class="p">,</span> <span class="bp">None</span><span class="p">,</span> <span class="bp">None</span><span class="p">,</span> <span class="bp">None</span>
    <span class="c"># calculate the output (o) - unnormalized log probabilities of classes</span>
    <span class="c"># calculate yhat - softmax of the output</span>
    <span class="c"># calculate the cross-entropy loss</span>
    <span class="c"># calculate the derivative of the cross-entropy softmax loss with respect to the output (o)</span>
    <span class="c"># calculate the gradients with respect to the output parameters V and c</span>
    <span class="c"># calculate the gradients with respect to the hidden layer h</span>

    <span class="k">return</span> <span class="n">loss</span><span class="p">,</span> <span class="n">dh</span><span class="p">,</span> <span class="n">dV</span><span class="p">,</span> <span class="n">dc</span>

</code></pre></div></div>

<p>Implementacija kostura funkcije za ažuriranje parametara modela (težina) bi mogla izgledati ovako:</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># ...</span>
<span class="c"># Code is nested in class definition, indentation is not representative.</span>

<span class="c"># The inputs to the function are just indicative since the variables are mostly present as class properties</span>

<span class="k">def</span> <span class="nf">update</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">dU</span><span class="p">,</span> <span class="n">dW</span><span class="p">,</span> <span class="n">db</span><span class="p">,</span> <span class="n">dV</span><span class="p">,</span> <span class="n">dc</span><span class="p">,</span>
                 <span class="n">U</span><span class="p">,</span> <span class="n">W</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">V</span><span class="p">,</span> <span class="n">c</span><span class="p">,</span>
                 <span class="n">memory_U</span><span class="p">,</span> <span class="n">memory_W</span><span class="p">,</span> <span class="n">memory_b</span><span class="p">,</span> <span class="n">memory_V</span><span class="p">,</span> <span class="n">memory_c</span><span class="p">):</span>

    <span class="c"># update memory matrices</span>
    <span class="c"># perform the Adagrad update of parameters</span>
    <span class="k">pass</span>

</code></pre></div></div>

<p>Implementacija kostura petlje za kontrolu toka podataka te iteriranja optimizacijskog procesa bi mogla izgledati kao u nastavku:</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># ...</span>
<span class="c"># code not necessarily nested in class definition</span>

<span class="k">def</span> <span class="nf">run_language_model</span><span class="p">(</span><span class="n">dataset</span><span class="p">,</span> <span class="n">max_epochs</span><span class="p">,</span> <span class="n">hidden_size</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span> <span class="n">sequence_length</span><span class="o">=</span><span class="mi">30</span><span class="p">,</span> <span class="n">learning_rate</span><span class="o">=</span><span class="mf">1e-1</span><span class="p">,</span> <span class="n">sample_every</span><span class="o">=</span><span class="mi">100</span><span class="p">):</span>
    
    <span class="n">vocab_size</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">dataset</span><span class="o">.</span><span class="n">sorted_chars</span><span class="p">)</span>
    <span class="n">RNN</span> <span class="o">=</span> <span class="bp">None</span> <span class="c"># initialize the recurrent network</span>

    <span class="n">current_epoch</span> <span class="o">=</span> <span class="mi">0</span> 
    <span class="n">batch</span> <span class="o">=</span> <span class="mi">0</span>

    <span class="n">h0</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">hidden_size</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>

    <span class="n">average_loss</span> <span class="o">=</span> <span class="mi">0</span>

    <span class="k">while</span> <span class="n">current_epoch</span> <span class="o">&lt;</span> <span class="n">max_epochs</span><span class="p">:</span> 
        <span class="n">e</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">dataset</span><span class="o">.</span><span class="n">next_minibatch</span><span class="p">()</span>
        
        <span class="k">if</span> <span class="n">e</span><span class="p">:</span> 
            <span class="n">current_epoch</span> <span class="o">+=</span> <span class="mi">1</span>
            <span class="n">h0</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">hidden_size</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>
            <span class="c"># why do we reset the hidden state here?</span>

        <span class="c"># One-hot transform the x and y batches</span>
        <span class="n">x_oh</span><span class="p">,</span> <span class="n">y_oh</span> <span class="o">=</span> <span class="bp">None</span><span class="p">,</span> <span class="bp">None</span>

        <span class="c"># Run the recurrent network on the current batch</span>
        <span class="c"># Since we are using windows of a short length of characters,</span>
        <span class="c"># the step function should return the hidden state at the end</span>
        <span class="c"># of the unroll. You should then use that hidden state as the</span>
        <span class="c"># input for the next minibatch. In this way, we artificially</span>
        <span class="c"># preserve context between batches.</span>
        <span class="n">loss</span><span class="p">,</span> <span class="n">h0</span> <span class="o">=</span> <span class="n">RNN</span><span class="o">.</span><span class="n">step</span><span class="p">(</span><span class="n">h0</span><span class="p">,</span> <span class="n">x_oh</span><span class="p">,</span> <span class="n">y_oh</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">batch</span> <span class="o">%</span> <span class="n">sample_every</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span> 
            <span class="c"># run sampling (2.2)</span>
            <span class="k">pass</span>
        <span class="n">batch</span> <span class="o">+=</span> <span class="mi">1</span>

</code></pre></div></div>

<p>Funkcija <code class="highlighter-rouge">step</code> kojoj kostur nije opisan sadržava logiku pokretanja jednog prolaza unaprijed i unatrag povratne neuronske mreže. Kao ulaze prima vektor početnog stanja skrivenog sloja, ohe-hot kodirane ulaze i izlaze dimenzija BxTxV, pri čemu je B veličina minibatcha, T broj vremenskih koraka a V veličina vokabulara. Kao izlaze dobivamo gubitak u tom koraku te skriveno stanje iz <strong>zadnjeg koraka</strong>, koje spremamo kao novo početno stanje.</p>

<h4 id="22-uzorkovanje-podataka-na-temelju-naučene-mreže">2.2: Uzorkovanje podataka na temelju naučene mreže</h4>

<p>Kod treniranja mreže smo implicitno uzimali idući znak niza umjesto predikciju mreže kao ulaz u idućem vremenskom koraku. Ovaj pristup nije primjenjiv za vrijeme testiranja (kad nam nije dostupan točni idući element niza). Iz ovog razloga greška na skupu za treniranje je umjetno drastično manja od greške na skupu za testiranje (validaciju).</p>

<p>Unutar okvira laboratorijske vježbe nećemo ulaziti u dubinu uzorkovanja nizova, već ćemo obraditi najosnovniji pristup. Svakih <code class="highlighter-rouge">sample_every</code> minibatcheva pokrenuti ćemo metodu za uzorkovanje iz naše povratne neuronske mreže na idući način:</p>

<ol>
  <li>Spremite trenutno skriveno stanje mreže (<code class="highlighter-rouge">h_train</code>)</li>
  <li>Inicijalizirajte prazno skriveno stanje (<code class="highlighter-rouge">h0_sample</code>)</li>
  <li>Definirajte <em>seed</em> niz znakova koji će “zagrijati” mrežu- npr: <code class="highlighter-rouge">seed ='HAN:\nIs that good or bad?\n\n'</code></li>
  <li>Definirajte duljinu niza za koji ćete uzorkovati (<code class="highlighter-rouge">n_sample=300</code>)</li>
  <li>Pokrenite mrežu unaprijed na svim znakovima iz niza “seed”</li>
  <li>Vratite uzorkovan niz podataka do duljine <code class="highlighter-rouge">n_sample</code> - <code class="highlighter-rouge">len(seed)</code></li>
</ol>

<p>Kostur funkcije za uzorkovanje bi mogao (ali ne mora) izgledati kao u nastavku:</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># ...</span>
<span class="c"># code not necessarily nested in class definition</span>
<span class="k">def</span> <span class="nf">sample</span><span class="p">(</span><span class="n">seed</span><span class="p">,</span> <span class="n">n_sample</span><span class="p">):</span>
    <span class="n">h0</span><span class="p">,</span> <span class="n">seed_onehot</span><span class="p">,</span> <span class="n">sample</span> <span class="o">=</span> <span class="bp">None</span><span class="p">,</span> <span class="bp">None</span><span class="p">,</span> <span class="bp">None</span> 
    <span class="c"># inicijalizirati h0 na vektor nula</span>
    <span class="c"># seed string pretvoriti u one-hot reprezentaciju ulaza</span>
    
    <span class="k">return</span> <span class="n">sample</span>

</code></pre></div></div>

<h3 id="zadatak-3-višeslojna-povratna-neuronska-mreža-u-tensorflowu">Zadatak 3: višeslojna povratna neuronska mreža u tensorflowu</h3>

<p>TODO</p>

  </article>

</div>

      </div>
    </div>

    <footer class="site-footer">

  <div class="wrap">

    <div class="footer-col-1 column">
      <ul>
        
        <li>
          <a href="https://github.com/dlunizg">
            <span class="icon github">
              <svg version="1.1" class="github-icon-svg" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px" viewBox="0 0 16 16" enable-background="new 0 0 16 16" xml:space="preserve">
                <path fill-rule="evenodd" clip-rule="evenodd" fill="#C2C2C2" d="M7.999,0.431c-4.285,0-7.76,3.474-7.76,7.761
                c0,3.428,2.223,6.337,5.307,7.363c0.388,0.071,0.53-0.168,0.53-0.374c0-0.184-0.007-0.672-0.01-1.32
                c-2.159,0.469-2.614-1.04-2.614-1.04c-0.353-0.896-0.862-1.135-0.862-1.135c-0.705-0.481,0.053-0.472,0.053-0.472
                c0.779,0.055,1.189,0.8,1.189,0.8c0.692,1.186,1.816,0.843,2.258,0.645c0.071-0.502,0.271-0.843,0.493-1.037
                C4.86,11.425,3.049,10.76,3.049,7.786c0-0.847,0.302-1.54,0.799-2.082C3.768,5.507,3.501,4.718,3.924,3.65
                c0,0,0.652-0.209,2.134,0.796C6.677,4.273,7.34,4.187,8,4.184c0.659,0.003,1.323,0.089,1.943,0.261
                c1.482-1.004,2.132-0.796,2.132-0.796c0.423,1.068,0.157,1.857,0.077,2.054c0.497,0.542,0.798,1.235,0.798,2.082
                c0,2.981-1.814,3.637-3.543,3.829c0.279,0.24,0.527,0.713,0.527,1.437c0,1.037-0.01,1.874-0.01,2.129
                c0,0.208,0.14,0.449,0.534,0.373c3.081-1.028,5.302-3.935,5.302-7.362C15.76,3.906,12.285,0.431,7.999,0.431z"></path>
              </svg>
            </span>
            <span class="username">dlunizg</span>
          </a>
        </li>
        
        <li>
          <a href="mailto:ivan.kreso@fer.hr">ivan.kreso@fer.hr</a>
        </li>
      </ul>
    </div>

    <div class="footer-col-2 column">
        
    </div>

    <div class="footer-col-3 column">
      
    </div>

  </div>

</footer>


    <!-- mathjax -->
    <script src="./vježba_ modeliranje nizova povratnim neuronskim mrežama_files/MathJax.js.download" id=""></script>
    
<div style="position: absolute; width: 0px; height: 0px; overflow: hidden; padding: 0px; border: 0px; margin: 0px;"><div id="MathJax_Font_Test" style="position: absolute; visibility: hidden; top: 0px; left: 0px; width: auto; padding: 0px; border: 0px; margin: 0px; white-space: nowrap; text-align: left; text-indent: 0px; text-transform: none; line-height: normal; letter-spacing: normal; word-spacing: normal; font-size: 40px; font-weight: normal; font-style: normal; font-family: MathJax_Size2, sans-serif;"></div></div></body></html>